import{F as nt}from"./new-DvaRG_eI.js";import{D as Q}from"./datetime-3JD3bssD.js";import{D as J,f as X}from"./date-time-CEONMtaY.js";import{E as at}from"./fill-jYfh2lBR.js";import{E as lt}from"./preview-CdLuzLgj.js";import{_ as mt}from"./link-CVIq4c0k.js";import{_ as dt}from"./link-if-can-B5zC8OjL.js";import{u as ut}from"./review-state-DuiKQZfx.js";import{aa as ct,ay as bt,_ as y,u as g,z as Y,r as d,l as tt,c as l,o as i,d as o,p,e as f,t as n,F as v,j as I,q as k,g as F,i as h,k as et,f as w,w as ft,L as pt,v as st,P as ot,a as ht,D as it,n as rt,H as _t}from"./index-BJJ6YbMy.js";import{_ as vt}from"./section-EpBA88m2.js";import{s as Ft}from"./sort-bd-YlzAd.js";import{_ as kt}from"./modal-BMSEXbZM.js";import{u as wt}from"./request--gXHIWga.js";import"./file-drop-zone-DebRuhhk.js";import"./sentence-separator-DdZUROGk.js";import"./hover-card-hXE3Fll1.js";var yt=ct(function(t,s,a){var u=t(s),r=t(a);return u<r?-1:u>r?1:0}),gt=bt(function(t,s){return Array.prototype.slice.call(s,0).sort(function(a,u){for(var r=0,m=0;r===0&&m<t.length;)r=t[m](a,u),m+=1;return r})});function V(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{en:{action:{fill:{t:0,b:{t:2,i:[{t:3}],s:"Fill Form"}}},formClosingTip:{t:0,b:{t:2,i:[{t:3}],s:"This Form is Closing and accepting its final Submissions. It is not downloadable but still accepts Submissions."}}}}})}function P(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{cs:{action:{fill:{t:0,b:{t:2,i:[{t:3}],s:"Vyplnit formulář"}}},formClosingTip:{t:0,b:{t:2,i:[{t:3}],s:"Tento formulář se uzavírá a přijímá poslední podání. Není ke stažení, ale stále přijímá příspěvky."}}},de:{action:{fill:{t:0,b:{t:2,i:[{t:3}],s:"Formular ausfüllen"}}},formClosingTip:{t:0,b:{t:2,i:[{t:3}],s:"Dieses Formular steht auf Schliessen und akzeptiert seine endgültigen Übermittlungen. Es kann nicht heruntergeladen werden, aber Übermittlungen werden noch akzeptiert."}}},es:{action:{fill:{t:0,b:{t:2,i:[{t:3}],s:"Llenar formulario"}}},formClosingTip:{t:0,b:{t:2,i:[{t:3}],s:"Este formulario se está cerrando y aceptando sus Envíos finales. No se puede descargar, pero aún acepta Envíos."}}},fr:{action:{fill:{t:0,b:{t:2,i:[{t:3}],s:"Remplir le formulaire"}}},formClosingTip:{t:0,b:{t:2,i:[{t:3}],s:"Ce formulaire est en cours de fermeture et accepte ses dernières soumissions. Il n'est plus téléchargeable mais peut encore recevoir des soumissions."}}},id:{action:{fill:{t:0,b:{t:2,i:[{t:3}],s:"Isi Formulir"}}}},it:{action:{fill:{t:0,b:{t:2,i:[{t:3}],s:"Compila il Formulario"}}},formClosingTip:{t:0,b:{t:2,i:[{t:3}],s:"Questo Formulario è in fase di chiusura e accetta i suoi ultimi Invii. Non è scaricabile ma tuttavia accetta Invii."}}},ja:{action:{fill:{t:0,b:{t:2,i:[{t:3}],s:"フォームに記入"}}}},pt:{action:{fill:{t:0,b:{t:2,i:[{t:3}],s:"Preencher formulário"}}},formClosingTip:{t:0,b:{t:2,i:[{t:3}],s:"Este Formulário está sendo fechado e aceitando suas respostas finais. Ele não pode ser baixado, mas ainda aceita Respostas."}}},sw:{action:{fill:{t:0,b:{t:2,i:[{t:3}],s:"Jaza Fomu"}}},formClosingTip:{t:0,b:{t:2,i:[{t:3}],s:"Fomu Hii Inafungwa na inakubali Mawasilisho yake ya mwisho. Haiwezi kupakuliwa lakini bado inakubali Mawasilisho."}}},"zh-Hant":{action:{fill:{t:0,b:{t:2,i:[{t:3}],s:"填寫表格"}}},formClosingTip:{t:0,b:{t:2,i:[{t:3}],s:"該表格即將結束並接受其最終提交資料。它不可下載，但仍接受提交。"}}}}})}const D={name:"FormRow",components:{DateTime:J,EnketoFill:at,EnketoPreview:lt,FormLink:mt,LinkIfCan:dt},props:{form:{type:Object,required:!0},showActions:{type:Boolean,default:!0}},setup(){const{project:e,duplicateFormNames:t}=g(),{formPath:s}=Y(),{reviewStateIcon:a}=ut();return{project:e,duplicateFormNames:t,formPath:s,reviewStateIcon:a}},computed:{visibleReviewStates:()=>["received","hasIssues","edited"],urlFilterEncode(){return new Map().set("received","null").set("hasIssues","%27hasIssues%27").set("edited","%27edited%27")},editPath(){return this.formPath(this.form.projectId,this.form.xmlFormId,"draft")},showIdForDuplicateName(){if(this.duplicateFormNames==null)return!1;const e=this.form.nameOrId.toLocaleLowerCase();return this.duplicateFormNames.has(e)},lastSubmissionTooltip(){const{lastSubmission:e}=this.form,t=this.$t("header.lastSubmission");if(e==null)return t;const s=X(Q.fromISO(e));return`${t}
${s}`}}},Tt={class:"form-row"},Ct={class:"name"},$t={key:0,class:"duplicate-form-id"},St={class:"last-submission"},It={class:"total-submissions"},Dt={key:1,class:"not-published",colspan:"2"},jt={key:2,class:"actions"},Rt={"aria-hidden":"true"},Et={class:"sr-only"};function At(e,t,s,a,u,r){const m=d("form-link"),c=d("link-if-can"),b=d("date-time"),_=d("enketo-preview"),S=d("enketo-fill"),T=d("router-link"),$=tt("tooltip");return i(),l("tr",Tt,[o("td",Ct,[f(m,{form:s.form},null,8,["form"]),r.showIdForDuplicateName?(i(),l("span",$t,"("+n(s.form.xmlFormId)+")",1)):p("",!0)]),(i(!0),l(v,null,I(r.visibleReviewStates,C=>(i(),l("td",{key:C,class:"review-state"},[s.form.publishedAt!=null?k((i(),F(c,{key:0,to:a.formPath(s.form.projectId,s.form.xmlFormId,`submissions?reviewState=${r.urlFilterEncode.get(C)}`)},{default:h(()=>[o("span",null,n(e.$n(s.form.reviewStates[C],"default")),1),o("span",{class:et(a.reviewStateIcon(C))},null,2)]),_:2},1032,["to"])),[[$,e.$t(`reviewState.${C}`),void 0,{"no-aria":!0}]]):p("",!0)]))),128)),s.form.publishedAt!=null?(i(),l(v,{key:0},[o("td",St,[k((i(),l("span",null,[s.form.lastSubmission!=null?(i(),F(c,{key:0,to:a.formPath(s.form.projectId,s.form.xmlFormId,"submissions")},{default:h(()=>[f(b,{iso:s.form.lastSubmission,relative:"past",tooltip:!1},null,8,["iso"]),t[0]||(t[0]=o("span",{class:"icon-clock-o"},null,-1))]),_:1,__:[0]},8,["to"])):(i(),l(v,{key:1},[w(n(e.$t("submission.noSubmission")),1)],64))])),[[$,r.lastSubmissionTooltip,void 0,{"no-aria":!0}]])]),o("td",It,[k((i(),F(c,{to:a.formPath(s.form.projectId,s.form.xmlFormId,"submissions")},{default:h(()=>[o("span",null,n(e.$n(s.form.submissions,"default")),1),t[1]||(t[1]=o("span",{class:"icon-asterisk"},null,-1))]),_:1,__:[1]},8,["to"])),[[$,e.$t("common.totalSubmissions"),void 0,{"no-aria":!0}]])])],64)):(i(),l("td",Dt,[o("span",null,n(e.$t("formState.unpublished")),1),t[2]||(t[2]=o("span",{class:"icon-asterisk"},null,-1))])),s.showActions?(i(),l("td",jt,[s.form.state!=="closed"?(i(),l(v,{key:0},[s.form.state==="closing"?(i(),l(v,{key:0},[k((i(),l("span",Rt,[t[3]||(t[3]=o("span",{class:"icon-clock-o closing-icon"},null,-1)),o("span",null,n(e.$t("formState.closing")),1)])),[[$,void 0,void 0,{"sr-only":!0}]]),o("span",Et,n(e.$t("formClosingTip")),1)],64)):s.form.publishedAt!=null?(i(),l(v,{key:1},[a.project.permits("project.update")?(i(),F(_,{key:0,"form-version":s.form},null,8,["form-version"])):(i(),F(S,{key:1,"form-version":s.form},{default:h(()=>[t[4]||(t[4]=o("span",{class:"icon-edit"},null,-1)),w(n(e.$t("action.fill")),1)]),_:1,__:[4]},8,["form-version"]))],64)):(i(),F(T,{key:2,to:r.editPath,class:"btn btn-default"},{default:h(()=>[t[5]||(t[5]=o("span",{class:"icon-pencil"},null,-1)),o("span",null,n(e.$t("action.edit")),1)]),_:1,__:[5]},8,["to"]))],64)):p("",!0)])):p("",!0)])}typeof V=="function"&&V(D);typeof P=="function"&&P(D);const Nt=y(D,[["render",At]]);function O(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{en:{header:{closedForms:{t:0,b:{t:2,i:[{t:3}],s:"Closed Forms"}},reviewStates:{t:0,b:{t:2,i:[{t:3}],s:"Review States"}},latest:{t:0,b:{t:2,i:[{t:3}],s:"Latest"}},idAndVersion:{t:0,b:{t:2,i:[{t:3}],s:"ID and Version"}}}}}})}function L(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{cs:{header:{closedForms:{t:0,b:{t:2,i:[{t:3}],s:"Zavřené formuláře"}},reviewStates:{t:0,b:{t:2,i:[{t:3}],s:"Přehled stavů"}},latest:{t:0,b:{t:2,i:[{t:3}],s:"Poslední"}},idAndVersion:{t:0,b:{t:2,i:[{t:3}],s:"ID a Verze"}}}},de:{header:{closedForms:{t:0,b:{t:2,i:[{t:3}],s:"Geschlossene Formulare"}},reviewStates:{t:0,b:{t:2,i:[{t:3}],s:"Überprüfungsstaaten"}},latest:{t:0,b:{t:2,i:[{t:3}],s:"Letzte"}},idAndVersion:{t:0,b:{t:2,i:[{t:3}],s:"ID und Version"}}}},es:{header:{closedForms:{t:0,b:{t:2,i:[{t:3}],s:"Formularios cerrados"}},reviewStates:{t:0,b:{t:2,i:[{t:3}],s:"Estados de revisión"}},latest:{t:0,b:{t:2,i:[{t:3}],s:"Más reciente"}},idAndVersion:{t:0,b:{t:2,i:[{t:3}],s:"ID y versión"}}}},fr:{header:{closedForms:{t:0,b:{t:2,i:[{t:3}],s:"Formulaires fermés"}},reviewStates:{t:0,b:{t:2,i:[{t:3}],s:"États de révision"}},latest:{t:0,b:{t:2,i:[{t:3}],s:"Plus ancien"}},idAndVersion:{t:0,b:{t:2,i:[{t:3}],s:"Identifiant et version"}}}},id:{header:{latest:{t:0,b:{t:2,i:[{t:3}],s:"Terbaru"}},idAndVersion:{t:0,b:{t:2,i:[{t:3}],s:"ID dan Versi"}}}},it:{header:{closedForms:{t:0,b:{t:2,i:[{t:3}],s:"Formulari chiusi"}},reviewStates:{t:0,b:{t:2,i:[{t:3}],s:"Stati Revisione"}},latest:{t:0,b:{t:2,i:[{t:3}],s:"Ultimo"}},idAndVersion:{t:0,b:{t:2,i:[{t:3}],s:"ID e Versione"}}}},ja:{header:{idAndVersion:{t:0,b:{t:2,i:[{t:3}],s:"フォームIDとバージョン"}}}},pt:{header:{closedForms:{t:0,b:{t:2,i:[{t:3}],s:"Formulários Fechados"}},reviewStates:{t:0,b:{t:2,i:[{t:3}],s:"Status de Revisão"}},latest:{t:0,b:{t:2,i:[{t:3}],s:"Mais recentes"}},idAndVersion:{t:0,b:{t:2,i:[{t:3}],s:"ID e versão"}}}},sw:{header:{closedForms:{t:0,b:{t:2,i:[{t:3}],s:"Fomu Zilizofungwa"}},reviewStates:{t:0,b:{t:2,i:[{t:3}],s:"Kagua Majimbo"}},latest:{t:0,b:{t:2,i:[{t:3}],s:"karibuni"}},idAndVersion:{t:0,b:{t:2,i:[{t:3}],s:"Kitambulisho na Toleo"}}}},"zh-Hant":{header:{closedForms:{t:0,b:{t:2,i:[{t:3}],s:"封閉表單"}},reviewStates:{t:0,b:{t:2,i:[{t:3}],s:"審查狀態"}},latest:{t:0,b:{t:2,i:[{t:3}],s:"最新的"}},idAndVersion:{t:0,b:{t:2,i:[{t:3}],s:"ID和版本"}}}}}})}const j={name:"FormTable",components:{FormRow:Nt},props:{sortFunc:{type:Function,required:!0},showClosed:{type:Boolean,default:!1}},setup(){const{project:e,forms:t}=g();return{project:e,forms:t}},computed:{showActions(){return this.project.permits("project.update")||this.project.permits("submission.create")},showTable(){return this.formsToShow.length>0||!this.showClosed},formsToShow(){if(!this.forms.dataExists)return[];const e=this.showClosed?this.forms.filter(t=>t.state==="closed"):this.forms.filter(t=>t.state!=="closed");return e.sort(this.sortFunc),e}}},zt={key:0,class:"table form-table"},Vt={key:0},Pt={colspan:"7"},Ot={key:1},Lt={class:"review-state",colspan:"3"},Mt={class:"last-submission"},qt={class:"total-submissions"},Ht={key:0,class:"actions"},Bt={key:0};function xt(e,t,s,a,u,r){const m=d("form-row");return a.project.dataExists&&r.showTable?(i(),l("table",zt,[o("thead",null,[s.showClosed?(i(),l("tr",Vt,[o("th",Pt,n(e.$t("header.closedForms")),1)])):(i(),l("tr",Ot,[o("th",null,n(e.$t("header.name")),1),o("th",Lt,n(e.$t("header.reviewStates")),1),o("th",Mt,n(e.$t("header.latest")),1),o("th",qt,n(e.$t("common.total")),1),r.showActions?(i(),l("th",Ht,n(e.$t("header.actions")),1)):p("",!0)]))]),a.forms.dataExists?(i(),l("tbody",Bt,[(i(!0),l(v,null,I(r.formsToShow,c=>(i(),F(m,{key:c.xmlFormId,form:c,"show-actions":r.showActions},null,8,["form","show-actions"]))),128))])):p("",!0)])):p("",!0)}typeof O=="function"&&O(j);typeof L=="function"&&L(j);const Kt=y(j,[["render",xt]]);function M(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{en:{sortOptions:{alphabetical:{t:0,b:{t:2,i:[{t:3}],s:"Alphabetical"}},newest:{t:0,b:{t:2,i:[{t:3}],s:"Newest"}}}}}})}function q(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{cs:{sortOptions:{alphabetical:{t:0,b:{t:2,i:[{t:3}],s:"Abecední"}},newest:{t:0,b:{t:2,i:[{t:3}],s:"Nejnovější"}}}},de:{sortOptions:{alphabetical:{t:0,b:{t:2,i:[{t:3}],s:"Alphabetisch"}},newest:{t:0,b:{t:2,i:[{t:3}],s:"Neueste"}}}},es:{sortOptions:{alphabetical:{t:0,b:{t:2,i:[{t:3}],s:"Alfabético"}},newest:{t:0,b:{t:2,i:[{t:3}],s:"El mas nuevo"}}}},fr:{sortOptions:{alphabetical:{t:0,b:{t:2,i:[{t:3}],s:"Alphabétique"}},newest:{t:0,b:{t:2,i:[{t:3}],s:"Plus récent"}}}},id:{sortOptions:{newest:{t:0,b:{t:2,i:[{t:3}],s:"Terbaru"}}}},it:{sortOptions:{alphabetical:{t:0,b:{t:2,i:[{t:3}],s:"Alfabetico"}},newest:{t:0,b:{t:2,i:[{t:3}],s:"Il più nuovo"}}}},pt:{sortOptions:{alphabetical:{t:0,b:{t:2,i:[{t:3}],s:"Em ordem alfabética"}},newest:{t:0,b:{t:2,i:[{t:3}],s:"Mais recentes"}}}},sw:{sortOptions:{alphabetical:{t:0,b:{t:2,i:[{t:3}],s:"Kialfabeti"}},newest:{t:0,b:{t:2,i:[{t:3}],s:"Mpya zaidi"}}}},"zh-Hant":{sortOptions:{alphabetical:{t:0,b:{t:2,i:[{t:3}],s:"按字母順序"}},newest:{t:0,b:{t:2,i:[{t:3}],s:"新表單優先"}}}}}})}const Ut={id:"form-sort"},Wt={class:"form-group"},Zt={id:"form-sort-label"},Gt=["value"],Qt={value:"alphabetical"},Jt={value:"latest"},Xt={value:"newest"},R=Object.assign({name:"FormSort"},{__name:"sort",props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e){return(t,s)=>(i(),l("div",Ut,[o("form",{class:"form-inline",onSubmit:s[1]||(s[1]=ft(()=>{},["prevent"]))},[o("label",Wt,[o("span",Zt,n(t.$t("action.sort")),1),o("select",{value:e.modelValue,class:"form-control",onChange:s[0]||(s[0]=a=>t.$emit("update:modelValue",a.target.value))},[o("option",Qt,n(t.$t("sortOptions.alphabetical")),1),o("option",Jt,n(t.$t("header.lastSubmission")),1),o("option",Xt,n(t.$t("sortOptions.newest")),1)],40,Gt)])],32)]))}});typeof M=="function"&&M(R);typeof q=="function"&&q(R);function H(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{en:{title:{t:0,b:{t:2,i:[{t:3}],s:"Forms"}},action:{create:{t:0,b:{t:2,i:[{t:3}],s:"New"}}},emptyTable:{t:0,b:{t:2,i:[{t:3}],s:"There are no Forms to show."}},alert:{create:{t:0,b:{t:2,i:[{t:3,v:"“"},{t:4,k:"name"},{t:3,v:"” has been created as a Form Draft."}]}}}}}})}function B(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{cs:{title:{t:0,b:{t:2,i:[{t:3}],s:"Formuláře"}},action:{create:{t:0,b:{t:2,i:[{t:3}],s:"Nový"}}},emptyTable:{t:0,b:{t:2,i:[{t:3}],s:"Nejsou k dispozici žádné formuláře."}}},de:{title:{t:0,b:{t:2,i:[{t:3}],s:"Formulare"}},action:{create:{t:0,b:{t:2,i:[{t:3}],s:"Neu"}}},emptyTable:{t:0,b:{t:2,i:[{t:3}],s:"Keine Formulare zum Anzeigen vorhanden."}}},es:{title:{t:0,b:{t:2,i:[{t:3}],s:"Formularios"}},action:{create:{t:0,b:{t:2,i:[{t:3}],s:"Nuevo"}}},emptyTable:{t:0,b:{t:2,i:[{t:3}],s:"No hay formularios para mostrar."}},alert:{create:{t:0,b:{t:2,i:[{t:3,v:'"'},{t:4,k:"name"},{t:3,v:'" se ha creado como borrador de formulario.'}]}}}},fr:{title:{t:0,b:{t:2,i:[{t:3}],s:"Formulaires"}},action:{create:{t:0,b:{t:2,i:[{t:3}],s:"Nouveau"}}},emptyTable:{t:0,b:{t:2,i:[{t:3}],s:"Il n'y a pas de formulaire à montrer."}},alert:{create:{t:0,b:{t:2,i:[{t:3,v:'"'},{t:4,k:"name"},{t:3,v:'" a été créé comme ébauche.'}]}}}},id:{title:{t:0,b:{t:2,i:[{t:3}],s:"Formulir"}},action:{create:{t:0,b:{t:2,i:[{t:3}],s:"Formulir Baru"}}},emptyTable:{t:0,b:{t:2,i:[{t:3}],s:"Tidak ada formulir untuk ditampilkan."}}},it:{title:{t:0,b:{t:2,i:[{t:3}],s:"Formulari"}},action:{create:{t:0,b:{t:2,i:[{t:3}],s:"Nuovo"}}},emptyTable:{t:0,b:{t:2,i:[{t:3}],s:"Non ci sono formulari da mostrare."}},alert:{create:{t:0,b:{t:2,i:[{t:3,v:"“"},{t:4,k:"name"},{t:3,v:"” è stato creato come bozza di formulario."}]}}}},ja:{title:{t:0,b:{t:2,i:[{t:3}],s:"フォーム"}},action:{create:{t:0,b:{t:2,i:[{t:3}],s:"新規作成"}}},emptyTable:{t:0,b:{t:2,i:[{t:3}],s:"表示できるフォームはありません。"}}},pt:{title:{t:0,b:{t:2,i:[{t:3}],s:"Formulários"}},action:{create:{t:0,b:{t:2,i:[{t:3}],s:"Novo"}}},emptyTable:{t:0,b:{t:2,i:[{t:3}],s:"Não há formulários para exibir."}}},sw:{title:{t:0,b:{t:2,i:[{t:3}],s:"Fomu"}},action:{create:{t:0,b:{t:2,i:[{t:3}],s:"Mpya"}}},emptyTable:{t:0,b:{t:2,i:[{t:3}],s:"hakuna Fomu za kuonyesha"}}},"zh-Hant":{title:{t:0,b:{t:2,i:[{t:3}],s:"表單"}},action:{create:{t:0,b:{t:2,i:[{t:3}],s:"新增"}}},emptyTable:{t:0,b:{t:2,i:[{t:3}],s:"沒有可顯示的表單。"}},alert:{create:{t:0,b:{t:2,i:[{t:3,v:"「"},{t:4,k:"name"},{t:3,v:"」已建立為表單草稿。"}]}}}}}})}const E={name:"FormList",components:{FormTable:Kt,FormNew:nt,FormSort:R,Loading:pt,PageSection:vt},inject:["alert"],setup(){const{project:e,forms:t}=g(),{formPath:s}=Y();return{project:e,forms:t,formPath:s}},data(){return{createModal:ot(),sortMode:"alphabetical"}},computed:{sortFunction(){return Ft[this.sortMode]}},methods:{async afterCreate(e){const t=this.$t("alert.create",{name:e.name!=null?e.name:e.xmlFormId});await this.$router.push(this.formPath(e.projectId,e.xmlFormId,"draft")),this.project.forms+=1,this.alert.success(t)}}},Yt={id:"form-list"},te={key:0,class:"empty-table-message"};function ee(e,t,s,a,u,r){const m=d("form-sort"),c=d("form-table"),b=d("loading"),_=d("page-section"),S=d("form-new");return i(),l("div",Yt,[f(_,null,{heading:h(()=>[o("span",null,n(e.$t("title")),1),a.project.dataExists&&a.project.permits("form.create")?(i(),l("button",{key:0,id:"form-list-create-button",type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=T=>u.createModal.show())},[t[3]||(t[3]=o("span",{class:"icon-plus-circle"},null,-1)),w(n(e.$t("action.create"))+"… ",1)])):p("",!0),f(m,{modelValue:u.sortMode,"onUpdate:modelValue":t[1]||(t[1]=T=>u.sortMode=T)},null,8,["modelValue"])]),body:h(()=>[f(c,{"sort-func":r.sortFunction},null,8,["sort-func"]),f(c,{"sort-func":r.sortFunction,"show-closed":!0},null,8,["sort-func"]),f(b,{state:a.forms.initiallyLoading},null,8,["state"]),a.forms.dataExists&&a.forms.length===0?(i(),l("p",te,n(e.$t("emptyTable")),1)):p("",!0)]),_:1}),f(S,st(u.createModal,{onHide:t[2]||(t[2]=T=>u.createModal.hide()),onSuccess:r.afterCreate}),null,16,["onSuccess"])])}typeof H=="function"&&H(E);typeof B=="function"&&B(E);const se=y(E,[["render",ee]]);function x(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{en:{deletedDate:{t:0,b:{t:2,i:[{t:3,v:"Deleted "},{t:4,k:"dateTime"}]}},disabled:{conflict:{t:0,b:{t:2,i:[{t:3}],s:"This Form cannot be restored because an active Form with the same ID exists."}}}}}})}function K(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{cs:{deletedDate:{t:0,b:{t:2,i:[{t:3,v:"Smazáno "},{t:4,k:"dateTime"}]}}},de:{deletedDate:{t:0,b:{t:2,i:[{t:3,v:"Gelöscht "},{t:4,k:"dateTime"}]}},disabled:{conflict:{t:0,b:{t:2,i:[{t:3}],s:"Dieses Formular kann nicht wiederhergestellt werden, weil ein aktives Formular mit derselben ID existiert."}}}},es:{deletedDate:{t:0,b:{t:2,i:[{t:3,v:"Borrado "},{t:4,k:"dateTime"}]}},disabled:{conflict:{t:0,b:{t:2,i:[{t:3}],s:"Este formulario no se puede restablecer porque existe un formulario activo con el mismo ID."}}}},fr:{deletedDate:{t:0,b:{t:2,i:[{t:3,v:"Supprimé le "},{t:4,k:"dateTime"}]}},disabled:{conflict:{t:0,b:{t:2,i:[{t:3}],s:"Ce formulaire ne peut être restauré car un Formulaire actif avec le même ID existe."}}}},id:{deletedDate:{t:0,b:{t:2,i:[{t:3,v:"Terhapus "},{t:4,k:"dateTime"}]}}},it:{deletedDate:{t:0,b:{t:2,i:[{t:3,v:"Eliminato "},{t:4,k:"dateTime"}]}},disabled:{conflict:{t:0,b:{t:2,i:[{t:3}],s:"Questo formulario non può essere ripristinato perché esiste un formulario attivo con lo stesso ID."}}}},ja:{deletedDate:{t:0,b:{t:2,i:[{t:3,v:"削除 "},{t:4,k:"dateTime"}]}}},pt:{deletedDate:{t:0,b:{t:2,i:[{t:3,v:"Excluído "},{t:4,k:"dateTime"}]}}},sw:{deletedDate:{t:0,b:{t:2,i:[{t:3,v:"Imefutwa "},{t:4,k:"dateTime"}]}}},"zh-Hant":{deletedDate:{t:0,b:{t:2,i:[{t:3,v:"已刪除"},{t:4,k:"dateTime"}]}},disabled:{conflict:{t:0,b:{t:2,i:[{t:3}],s:"該表單無法還原，因為存在具有相同 ID 的活動表單。"}}}}}})}const A={name:"FormTrashRow",components:{DateTime:J},props:{form:{type:Object,required:!0}},emits:["start-restore"],setup(){const{forms:e,deletedForms:t,duplicateFormNames:s}=g();return{forms:e,deletedForms:t,duplicateFormNames:s}},computed:{activeFormIds(){return this.forms.dataExists?this.forms.map(e=>e.xmlFormId):[]},disabled(){return this.activeFormIds.includes(this.form.xmlFormId)},disabledDescription(){return this.disabled?this.$t("disabled.conflict"):null},showIdForDuplicateName(){if(this.duplicateFormNames==null)return!1;const e=this.form.nameOrId.toLocaleLowerCase();return this.duplicateFormNames.has(e)},lastSubmissionTooltip(){const{lastSubmission:e}=this.form,t=this.$t("header.lastSubmission");if(e==null)return t;const s=X(Q.fromISO(e));return`${t}
${s}`}},methods:{openRestoreModal(e){this.$emit("start-restore",e)}}},oe={class:"form-trash-row"},ie={class:"name"},re={class:"form-name"},ne={key:0,class:"duplicate-form-id"},ae={class:"deleted"},le={class:"last-submission"},me={class:"total-submissions"},de={class:"actions"},ue=["aria-disabled","data-form-id"];function ce(e,t,s,a,u,r){const m=d("date-time"),c=d("i18n-t"),b=tt("tooltip");return i(),l("tr",oe,[o("td",ie,[o("span",re,n(s.form.nameOrId),1),r.showIdForDuplicateName?(i(),l("span",ne,"("+n(s.form.xmlFormId)+")",1)):p("",!0)]),o("td",ae,[f(c,{tag:"div",keypath:"deletedDate",class:"deleted-date"},{dateTime:h(()=>[f(m,{iso:s.form.deletedAt},null,8,["iso"])]),_:1})]),o("td",le,[k((i(),l("span",null,[s.form.lastSubmission!=null?(i(),l(v,{key:0},[f(m,{iso:s.form.lastSubmission,relative:"past",tooltip:!1},null,8,["iso"]),t[1]||(t[1]=o("span",{class:"icon-clock-o"},null,-1))],64)):(i(),l(v,{key:1},[w(n(e.$t("submission.noSubmission")),1)],64))])),[[b,r.lastSubmissionTooltip,void 0,{"no-aria":!0}]])]),o("td",me,[k((i(),l("span",null,[o("span",null,n(e.$n(s.form.submissions!=null?s.form.submissions:0,"default")),1),t[2]||(t[2]=o("span",{class:"icon-asterisk"},null,-1))])),[[b,e.$t("common.totalSubmissions"),void 0,{"no-aria":!0}]])]),o("td",de,[k((i(),l("button",{class:"form-trash-row-restore-button btn btn-default",type:"button","aria-disabled":r.disabled,"data-form-id":s.form.id,onClick:t[0]||(t[0]=_=>r.openRestoreModal(s.form))},[t[3]||(t[3]=o("span",{class:"icon-recycle"},null,-1)),w(n(e.$t("action.restore")),1)],8,ue)),[[b,r.disabledDescription,void 0,{"aria-describedby":!0}]])])])}typeof x=="function"&&x(A);typeof K=="function"&&K(A);const be=y(A,[["render",ce]]);function U(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{en:{title:{t:0,b:{t:2,i:[{t:3}],s:"Restore Form"}},introduction:[{t:0,b:{t:2,i:[{t:3,v:"Are you sure you want to restore the Form "},{t:4,k:"name"},{t:3,v:"?"}]}},{t:0,b:{t:2,i:[{t:3}],s:"The Form will be restored to its previous state, including all data, settings, and permissions."}},{t:0,b:{t:2,i:[{t:3}],s:"If the Form is deleted again, it will be another 30 days before it is removed."}}]}}})}function W(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{de:{title:{t:0,b:{t:2,i:[{t:3}],s:"Formular wiederherstellen"}},introduction:[{t:0,b:{t:2,i:[{t:3,v:"Sind Sie sicher dass Sie das Formular "},{t:4,k:"name"},{t:3,v:" wiederherstellen möchten?"}]}},{t:0,b:{t:2,i:[{t:3}],s:"Das Formular wird in seinem vorherigen Zustand wiederhergestellt, einschließlich aller Daten, Einstellungen und Berechtigungen."}},{t:0,b:{t:2,i:[{t:3}],s:"Wenn das Formular erneut gelöscht wird, dauert es 30 Tage bis es entfernt wird."}}]},es:{title:{t:0,b:{t:2,i:[{t:3}],s:"Restablecer formulario"}},introduction:[{t:0,b:{t:2,i:[{t:3,v:"¿Está seguro de que desea restablecer el formulario "},{t:4,k:"name"},{t:3,v:"?"}]}},{t:0,b:{t:2,i:[{t:3}],s:"El formulario se restaurará a su estado anterior, incluidos todos los datos, configuraciones y permisos."}},{t:0,b:{t:2,i:[{t:3}],s:"Si el formulario se elimina nuevamente, pasarán otros 30 días antes de que se elimine."}}]},fr:{title:{t:0,b:{t:2,i:[{t:3}],s:"Restaurer le Formulaire"}},introduction:[{t:0,b:{t:2,i:[{t:3,v:"Êtes vous certain(e) de vouloir restaurer le Formulaire "},{t:4,k:"name"},{t:3,v:" ?"}]}},{t:0,b:{t:2,i:[{t:3}],s:"Le formulaire sera restauré dans son état précédent, incluant toutes les données, paramètres et permissions."}},{t:0,b:{t:2,i:[{t:3}],s:"Si le formulaire est à nouveau supprimé, il faudra attendre à nouveau 30 jours avant qu'il ne soit retiré."}}]},it:{title:{t:0,b:{t:2,i:[{t:3}],s:"Ripristina Formulario"}},introduction:[{t:0,b:{t:2,i:[{t:3,v:"Sei sicuro di voler ripristinare il formulario "},{t:4,k:"name"},{t:3,v:" ?"}]}},{t:0,b:{t:2,i:[{t:3}],s:"Il Formulario verrà ripristinato allo stato precedente, inclusi tutti i dati, le impostazioni e le autorizzazioni."}},{t:0,b:{t:2,i:[{t:3}],s:"Se il Formulario viene nuovamente eliminato, ci vorranno altri 30 giorni prima che venga rimosso."}}]},pt:{title:{t:0,b:{t:2,i:[{t:3}],s:"Recuperar Formulário"}}},"zh-Hant":{title:{t:0,b:{t:2,i:[{t:3}],s:"還原表格"}},introduction:[{t:0,b:{t:2,i:[{t:3,v:"您確定要還原表格"},{t:4,k:"name"},{t:3,v:"吗？"}]}},{t:0,b:{t:2,i:[{t:3}],s:"表單將恢復到先前的狀態，包括所有資料、設定和權限。"}},{t:0,b:{t:2,i:[{t:3}],s:"如果再次刪除該表格，則需要再過 30 天才會被刪除。"}}]}}})}const N={name:"FormRestore",components:{Modal:kt,Spinner:ht},props:{state:Boolean,form:Object},emits:["hide","success"],setup(){const{request:e,awaitingResponse:t}=wt();return{request:e,awaitingResponse:t}},methods:{doRestore(){this.request({method:"POST",url:it.restoreForm(this.form.projectId,this.form.id)}).then(()=>{this.$emit("success")}).catch(rt)}}},fe={key:0,class:"modal-introduction"},pe={class:"modal-actions"},he=["aria-disabled"],_e=["aria-disabled"];function ve(e,t,s,a,u,r){const m=d("i18n-t"),c=d("spinner"),b=d("modal");return i(),F(b,{id:"form-restore",state:s.state,hideable:!a.awaitingResponse,backdrop:"",onHide:t[2]||(t[2]=_=>e.$emit("hide"))},{title:h(()=>[w(n(e.$t("title")),1)]),body:h(()=>[s.form?(i(),l("div",fe,[f(m,{tag:"p",keypath:"introduction[0]"},{name:h(()=>[o("strong",null,n(s.form.nameOrId),1)]),_:1}),o("p",null,n(e.$t("introduction[1]")),1),o("p",null,n(e.$t("introduction[2]")),1)])):p("",!0),o("div",pe,[o("button",{type:"button",class:"btn btn-link","aria-disabled":a.awaitingResponse,onClick:t[0]||(t[0]=_=>e.$emit("hide"))},n(e.$t("action.noCancel")),9,he),o("button",{type:"button",class:"btn btn-danger","aria-disabled":a.awaitingResponse,onClick:t[1]||(t[1]=(..._)=>r.doRestore&&r.doRestore(..._))},[w(n(e.$t("action.yesProceed"))+" ",1),f(c,{state:a.awaitingResponse},null,8,["state"])],8,_e)])]),_:1},8,["state","hideable"])}typeof U=="function"&&U(N);typeof W=="function"&&W(N);const Fe=y(N,[["render",ve]]);function Z(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{en:{title:{t:0,b:{t:2,i:[{t:3}],s:"Trash"}},trashCount:{t:0,b:{t:2,i:[{t:3,v:"("},{t:4,k:"count"},{t:3,v:")"}]}},alert:{restore:{t:0,b:{t:2,i:[{t:3,v:"The Form “"},{t:4,k:"name"},{t:3,v:"” has been successfully restored."}]}}},message:{t:0,b:{t:2,i:[{t:3}],s:"Forms and Form-related data are deleted after 30 days in the Trash"}}}}})}function G(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{cs:{title:{t:0,b:{t:2,i:[{t:3}],s:"Koš"}},trashCount:{t:0,b:{t:2,i:[{t:3,v:"("},{t:4,k:"count"},{t:3,v:")"}]}},message:{t:0,b:{t:2,i:[{t:3}],s:"Formuláře a data související s formuláři jsou po 30 dnech odstraněny do koše."}}},de:{title:{t:0,b:{t:2,i:[{t:3}],s:"Papierkorb"}},trashCount:{t:0,b:{t:2,i:[{t:4,k:"count"}]}},message:{t:0,b:{t:2,i:[{t:3}],s:"Formulare und formularbezogene Daten werden nach 30 Tagen im Papierkorb gelöscht"}}},es:{title:{t:0,b:{t:2,i:[{t:3}],s:"Papelera"}},trashCount:{t:0,b:{t:2,i:[{t:3,v:"("},{t:4,k:"count"},{t:3,v:")"}]}},alert:{restore:{t:0,b:{t:2,i:[{t:3,v:"El formulario "},{t:4,k:"name"},{t:3,v:" fue restablecido correctamente."}]}}},message:{t:0,b:{t:2,i:[{t:3}],s:"Los formularios y los datos relacionados con los formularios se eliminan después de 30 días en la Papelera"}}},fr:{title:{t:0,b:{t:2,i:[{t:3}],s:"Corbeille"}},trashCount:{t:0,b:{t:2,i:[{t:3,v:"("},{t:4,k:"count"},{t:3,v:")"}]}},alert:{restore:{t:0,b:{t:2,i:[{t:3,v:'Le Formulaire "'},{t:4,k:"name"},{t:3,v:'" a été restauré.'}]}}},message:{t:0,b:{t:2,i:[{t:3}],s:"Le formulaire et les données associées sont supprimés après 30 jours passés dans la corbeille"}}},id:{title:{t:0,b:{t:2,i:[{t:3}],s:"Sampah"}}},it:{title:{t:0,b:{t:2,i:[{t:3}],s:"Cestino"}},trashCount:{t:0,b:{t:2,i:[{t:3,v:"("},{t:4,k:"count"},{t:3,v:")"}]}},alert:{restore:{t:0,b:{t:2,i:[{t:3,v:"Il formulario “"},{t:4,k:"name"},{t:3,v:"” è stato ripristinato con successo."}]}}},message:{t:0,b:{t:2,i:[{t:3}],s:"I formulari e i dati relativi ai formulari vengono eliminati dopo 30 giorni nel Cestino"}}},ja:{title:{t:0,b:{t:2,i:[{t:3}],s:"ゴミ箱"}},trashCount:{t:0,b:{t:2,i:[{t:3,v:"("},{t:4,k:"count"},{t:3,v:")"}]}},message:{t:0,b:{t:2,i:[{t:3}],s:"フォームとフォームに関連したデータは30日後に削除されます。"}}},pt:{title:{t:0,b:{t:2,i:[{t:3}],s:"Lixeira"}},trashCount:{t:0,b:{t:2,i:[{t:3,v:"("},{t:4,k:"count"},{t:3,v:")"}]}},message:{t:0,b:{t:2,i:[{t:3}],s:"Formulários e dados relacionados a Formulários são excluídos após 30 dias na Lixeira"}}},sw:{title:{t:0,b:{t:2,i:[{t:3}],s:"Takataka"}},trashCount:{t:0,b:{t:2,i:[{t:3,v:"("},{t:4,k:"count"},{t:3,v:")"}]}},message:{t:0,b:{t:2,i:[{t:3}],s:"Fomu na data inayohusiana na Fomu hufutwa baada ya siku 30 kwenye Tupio"}}},"zh-Hant":{title:{t:0,b:{t:2,i:[{t:3}],s:"垃圾桶"}},trashCount:{t:0,b:{t:2,i:[{t:3,v:"("},{t:4,k:"count"},{t:3,v:")"}]}},alert:{restore:{t:0,b:{t:2,i:[{t:3,v:"表單「"},{t:4,k:"name"},{t:3,v:"」已成功還原。"}]}}},message:{t:0,b:{t:2,i:[{t:3}],s:"表單和表單相關資料將在 30 天後從垃圾箱中刪除"}}}}})}const z={name:"FormTrashList",components:{FormTrashRow:be,FormRestore:Fe},inject:["alert"],emits:["restore"],setup(){const{project:e,deletedForms:t,currentUser:s}=g();return{project:e,deletedForms:t,currentUser:s,restoreForm:ot()}},computed:{count(){return this.deletedForms.dataExists?this.deletedForms.length:0},sortedDeletedForms(){return gt([yt(t=>t.deletedAt)])(this.deletedForms.data)},isFormTrashCollapsed(){return this.currentUser.preferences.projects[this.project.id].formTrashCollapsed}},created(){this.fetchDeletedForms(!1)},methods:{fetchDeletedForms(e){this.deletedForms.request({url:it.deletedForms(this.project.id),extended:!0,resend:e}).catch(rt)},afterRestore(){this.alert.success(this.$t("alert.restore",{name:this.restoreForm.form.name})),this.restoreForm.hide(),this.fetchDeletedForms(!0),this.$emit("restore")},onToggleTrashExpansion(e){const t=this.currentUser.preferences.projects[this.project.id];e.newState==="closed"?t.formTrashCollapsed=!0:t.formTrashCollapsed&&(t.formTrashCollapsed=!1)}}},ke={key:0,id:"form-trash-list"},we=["open"],ye={id:"form-trash-list-header"},ge={id:"form-trash-list-title"},Te={id:"form-trash-list-count"},Ce={id:"form-trash-list-note"},$e={id:"form-trash-list-table",class:"table"};function Se(e,t,s,a,u,r){const m=d("form-trash-row"),c=d("form-restore");return r.count>0?(i(),l("div",ke,[o("details",{open:!r.isFormTrashCollapsed,onToggle:t[2]||(t[2]=(...b)=>r.onToggleTrashExpansion&&r.onToggleTrashExpansion(...b))},[o("summary",null,[o("div",ye,[o("span",ge,[o("span",{id:"form-trash-expander",class:et({"icon-chevron-right":r.isFormTrashCollapsed,"icon-chevron-down":!r.isFormTrashCollapsed})},null,2),t[3]||(t[3]=o("span",{class:"icon-trash"},null,-1)),o("span",null,n(e.$t("title")),1)]),o("span",Te,n(e.$t("trashCount",{count:e.$n(r.count,"default")})),1),o("span",Ce,n(e.$t("message")),1)])]),o("table",$e,[o("tbody",null,[(i(!0),l(v,null,I(r.sortedDeletedForms,b=>(i(),F(m,{key:b.id,form:b,onStartRestore:t[0]||(t[0]=_=>a.restoreForm.show({form:_}))},null,8,["form"]))),128))])]),f(c,st(a.restoreForm,{onHide:t[1]||(t[1]=b=>a.restoreForm.hide()),onSuccess:r.afterRestore}),null,16,["onSuccess"])],40,we)])):p("",!0)}typeof Z=="function"&&Z(z);typeof G=="function"&&G(z);const Ie=y(z,[["render",Se]]),De={id:"project-overview"},Ue=Object.assign({name:"ProjectOverview"},{__name:"overview",props:{projectId:{type:String,required:!0}},emits:["fetch-forms"],setup(e,{emit:t}){const s=t,{project:a}=g();s("fetch-forms",!1);const u=_t(()=>a.dataExists&&a.permits("form.restore"));return(r,m)=>(i(),l("div",De,[f(se),u.value?(i(),F(Ie,{key:0,onRestore:m[0]||(m[0]=c=>r.$emit("fetch-forms",!0))})):p("",!0)]))}});export{Ue as default};
