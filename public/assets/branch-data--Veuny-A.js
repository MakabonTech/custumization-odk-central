import{u as N,Y as $,H as f,A as m,J as x,O as I,l as O,g as T,o as a,i as k,d as e,c as l,p as i,h as A,F as b,j as E,k as H,t as u,q as R,f as p,W as S,n as j}from"./index-BJJ6YbMy.js";import{_ as q}from"./modal-BMSEXbZM.js";const z={class:"table"},F={key:0,class:"icon-angle-down"},W={key:1,class:"icon-angle-up"},J={key:0},L=["data-version"],Y={key:0,href:"#"},G={href:"#"},K={key:0,class:"icon-info-circle"},M={key:0,href:"#"},P={class:"modal-actions"},X=Object.assign({name:"EntityBranchData"},{__name:"branch-data",props:{state:Boolean,highlight:Number},emits:["hide"],setup(g,{emit:y}){const v=g,V=y,{entityVersions:c}=N(),r=$(new Set),h=f(()=>v.state);m(h,n=>{n?r.add(v.highlight):r.clear()});const B=n=>{const{target:t}=n;if(t.closest("button")==null)if(r.clear(),t.tagName==="A"){n.preventDefault();const o=t.textContent.trim();if(o.startsWith("v"))r.add(Number.parseInt(o.replace("v",""),10));else for(const s of c)s.branch?.id===o&&r.add(s.version)}else{const o=n.target.closest("tr");o!=null&&r.add(Number.parseInt(o.dataset.version,10))}},d=x(!0),D=f(()=>d.value?c.data:c.toReversed()),_=()=>{d.value=!d.value};m(h,n=>{n||(d.value=!0)});const w=I(),C=n=>{V("hide");const{version:t}=n.target.closest("tr").dataset;S(()=>{w.push(`#v${t}`).catch(j)})};return(n,t)=>{const o=O("tooltip");return a(),T(q,{id:"entity-branch-data",state:h.value,hideable:"",size:"large",backdrop:"",onHide:t[1]||(t[1]=s=>n.$emit("hide")),onClick:B},{title:k(()=>t[2]||(t[2]=[p("Offline Branch Data",-1)])),body:k(()=>[e("table",z,[e("thead",null,[e("tr",null,[e("th",null,[e("div",null,[t[3]||(t[3]=e("span",null,"Version",-1)),e("button",{type:"button",class:"btn btn-link",onClick:_},[d.value?(a(),l("span",F)):(a(),l("span",W))])])]),t[4]||(t[4]=e("th",null,"Server base version",-1)),t[5]||(t[5]=e("th",null,"Branch ID",-1)),t[6]||(t[6]=e("th",null,"Trunk version",-1)),t[7]||(t[7]=e("th",null,"Branch base version",-1)),t[8]||(t[8]=e("th",null,"Actions",-1))])]),A(c).dataExists?(a(),l("tbody",J,[(a(!0),l(b,null,E(D.value,s=>(a(),l("tr",{key:s.version,class:H({highlight:r.has(s.version)}),"data-version":s.version},[e("td",null,"v"+u(s.version),1),e("td",null,[s.baseVersion!=null?(a(),l("a",Y," v"+u(s.baseVersion),1)):i("",!0)]),e("td",null,[s.branch!=null?(a(),l(b,{key:0},[e("a",G,u(s.branch.id),1),s.branchId==null?R((a(),l("span",K,null,512)),[[o,"This branch ID was inferred.",void 0,{"no-aria":!0}]]):i("",!0)],64)):i("",!0)]),e("td",null,[s.trunkVersion!=null?(a(),l("a",M," v"+u(s.trunkVersion),1)):i("",!0)]),e("td",null,[s.branchBaseVersion!=null?(a(),l(b,{key:0},[p(" v"+u(s.branchBaseVersion),1)],64)):i("",!0)]),e("td",null,[e("button",{type:"button",class:"btn btn-default",onClick:C},t[9]||(t[9]=[e("span",{class:"icon-eye"},null,-1),p("View in feed ",-1)]))])],10,L))),128))])):i("",!0)]),e("div",P,[e("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=s=>n.$emit("hide"))},u(n.$t("action.close")),1)])]),_:1},8,["state"])}}});export{X as default};
