import{_ as dt}from"./breadcrumbs-SpsHxTta.js";import{aa as lt,_ as D,a as ut,D as g,n as it,u as x,r as l,c as o,o as n,p as w,d as a,f as k,t as d,e as u,i as p,w as mt,z,H as W,J as ct,g as S,ai as bt,ag as A,l as R,F as f,j as V,q as I,R as q,k as T,v as P,s as vt,ak as pt,L as F,Q as ft,C as N,K as kt,a9 as ht,P as U}from"./index-BJJ6YbMy.js";import{_ as yt}from"./head-DeISpnNl.js";import{D as _t}from"./datetime-3JD3bssD.js";import{_ as st}from"./section-EpBA88m2.js";import{M as wt}from"./textarea-DfIc8ncZ.js";import{u as nt}from"./request--gXHIWga.js";import{_ as St}from"./actor-link-Dpyb0cJk.js";import{_ as gt}from"./link-6wXOPrfc.js";import{u as It}from"./hover-card-hXE3Fll1.js";import{_ as jt}from"./feed-entry-DFm4qUEV.js";import{M as Dt}from"./view-WEETJ_m_.js";import{_ as at}from"./review-state-m1o3bY3s.js";import{D as xt}from"./date-time-CEONMtaY.js";import{F as Et}from"./string-BTvN1Cbp.js";import{S as Ct,_ as At,u as Vt}from"./fields-BTJfkXdT.js";import{u as Pt}from"./submission-YNzTK585.js";import"./linkable-ByHyCO2J.js";import"./link-if-can-B5zC8OjL.js";import"./review-state-DuiKQZfx.js";import"./modal-BMSEXbZM.js";var Rt=lt(function(t,s,r){var m=t(s),i=t(r);return m>i?-1:m<i?1:0});function K(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{en:{editWithoutComment:{t:0,b:{t:2,i:[{t:3}],s:"You have made edits to this data. Please describe the changes you made."}}}}})}function $(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{cs:{editWithoutComment:{t:0,b:{t:2,i:[{t:3}],s:"Provedli jste úpravy těchto údajů. Popište prosím provedené změny."}}},de:{editWithoutComment:{t:0,b:{t:2,i:[{t:3}],s:"Sie haben die Daten geändert. Bitte beschreiben Sie die Änderungen, die Sie gemacht haben."}}},es:{editWithoutComment:{t:0,b:{t:2,i:[{t:3}],s:"Ha realizado modificaciones en estos datos. Describe los cambios que hiciste."}}},fr:{editWithoutComment:{t:0,b:{t:2,i:[{t:3}],s:"Vous avez édité cette soumission. Veuillez décrire vos changements."}}},id:{editWithoutComment:{t:0,b:{t:2,i:[{t:3}],s:"Anda telah mengubah redaksi pada data ini. Mohon jelaskan perubahan yang telah Anda buat"}}},it:{editWithoutComment:{t:0,b:{t:2,i:[{t:3}],s:"Hai apportato modifiche a questi dati. Per favore descrivi le modifiche apportate."}}},ja:{editWithoutComment:{t:0,b:{t:2,i:[{t:3}],s:"データが編集されました。あなたが実施した変更について説明して下さい。"}}},pt:{editWithoutComment:{t:0,b:{t:2,i:[{t:3}],s:"Você fez alterações nesse registro. Por favor, descreva as mudanças efetuadas."}}},sw:{editWithoutComment:{t:0,b:{t:2,i:[{t:3}],s:"Umefanya mabadiliko kwenye data hii. Tafadhali eleza mabadiliko uliyofanya."}}},"zh-Hant":{editWithoutComment:{t:0,b:{t:2,i:[{t:3}],s:"您已對此資料進行了編輯。請描述您所做的變更。"}}}}})}const O={name:"SubmissionComment",components:{Spinner:ut,MarkdownTextarea:wt},props:{projectId:{type:String,required:!0},xmlFormId:{type:String,required:!0},instanceId:{type:String,required:!0},feed:Array},emits:["success"],setup(){const{currentUser:e}=x(),{request:t,awaitingResponse:s}=nt();return{currentUser:e,request:t,awaitingResponse:s}},data(){return{body:""}},computed:{editWithoutComment(){if(this.feed==null)return!1;for(const e of this.feed)if(e.actorId===this.currentUser.id){if(e.body!=null)return!1;if(e.action==="submission.update.version")return!0}return!1}},methods:{submit(){this.request({method:"POST",url:g.submissionComments(this.projectId,this.xmlFormId,this.instanceId),data:{body:this.body}}).then(()=>{this.$emit("success"),this.body=""}).catch(it)}}},qt={key:0,role:"alert"},zt={class:"form-group"},Ft=["aria-disabled"];function Ot(e,t,s,r,m,i){const v=l("spinner"),c=l("markdown-textarea");return n(),o("form",{id:"submission-comment",onSubmit:t[1]||(t[1]=mt((...b)=>i.submit&&i.submit(...b),["prevent"]))},[i.editWithoutComment?(n(),o("div",qt,[t[2]||(t[2]=a("span",{class:"icon-pencil"},null,-1)),k(d(e.$t("editWithoutComment")),1)])):w("",!0),a("div",zt,[u(c,{modelValue:m.body,"onUpdate:modelValue":t[0]||(t[0]=b=>m.body=b),"default-text":e.$t("field.comment"),"show-footer":i.editWithoutComment||r.awaitingResponse,required:""},{default:p(()=>[a("button",{type:"submit",class:"btn btn-primary","aria-disabled":r.awaitingResponse},[k(d(e.$t("action.comment"))+" ",1),u(v,{state:r.awaitingResponse},null,8,["state"])],8,Ft)]),_:1},8,["modelValue","default-text","show-footer"])])],32)}typeof K=="function"&&K(O);typeof $=="function"&&$(O);const Bt=D(O,[["render",Ot]]),Lt=Object.assign({name:"EntityLink"},{__name:"link",props:{projectId:{type:[Number,String],required:!0},dataset:{type:String,required:!0},entity:{type:Object,required:!0}},setup(e){const t=e,{entityPath:s}=z(),r=W(()=>s(t.projectId,t.dataset,t.entity.uuid)),m=ct(null);return It(W(()=>m.value?.$el),"entity",()=>({projectId:t.projectId,dataset:t.dataset,uuid:t.entity.uuid})),(i,v)=>{const c=l("router-link");return n(),S(c,{ref_key:"link",ref:m,key:r.value,to:r.value},{default:p(()=>[k(d(e.entity.currentVersion.label),1)]),_:1},8,["to"])}}});function G(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{en:{editCaption:{added:{t:0,b:{t:2,i:[{t:3}],s:"(added)"}},deleted:{t:0,b:{t:2,i:[{t:3}],s:"(deleted)"}}},empty:{t:0,b:{t:2,i:[{t:3}],s:"empty"}}}}})}function J(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{cs:{editCaption:{added:{t:0,b:{t:2,i:[{t:3}],s:"(přidáno)"}},deleted:{t:0,b:{t:2,i:[{t:3}],s:"(smazáno)"}}},empty:{t:0,b:{t:2,i:[{t:3}],s:"prázdné"}}},de:{editCaption:{added:{t:0,b:{t:2,i:[{t:3}],s:"(hinzugefügt)"}},deleted:{t:0,b:{t:2,i:[{t:3}],s:"(gelöscht)"}}},empty:{t:0,b:{t:2,i:[{t:3}],s:"leer"}}},es:{editCaption:{added:{t:0,b:{t:2,i:[{t:3}],s:"(añadido)"}},deleted:{t:0,b:{t:2,i:[{t:3}],s:"(borrado)"}}},empty:{t:0,b:{t:2,i:[{t:3}],s:"vacío"}}},fr:{editCaption:{added:{t:0,b:{t:2,i:[{t:3}],s:"(ajouté)"}},deleted:{t:0,b:{t:2,i:[{t:3}],s:"(supprimé)"}}},empty:{t:0,b:{t:2,i:[{t:3}],s:"vide"}}},id:{editCaption:{added:{t:0,b:{t:2,i:[{t:3}],s:"(ditambahkan)"}},deleted:{t:0,b:{t:2,i:[{t:3}],s:"(dihapus)"}}},empty:{t:0,b:{t:2,i:[{t:3}],s:"kosong"}}},it:{editCaption:{added:{t:0,b:{t:2,i:[{t:3}],s:"(aggiunto)"}},deleted:{t:0,b:{t:2,i:[{t:3}],s:"(cancellato)"}}},empty:{t:0,b:{t:2,i:[{t:3}],s:"vuoto"}}},ja:{editCaption:{added:{t:0,b:{t:2,i:[{t:3}],s:"（追加済み）"}},deleted:{t:0,b:{t:2,i:[{t:3}],s:"（削除済み）"}}},empty:{t:0,b:{t:2,i:[{t:3}],s:"空"}}},pt:{editCaption:{added:{t:0,b:{t:2,i:[{t:3}],s:"(incluído)"}},deleted:{t:0,b:{t:2,i:[{t:3}],s:"(apagado)"}}},empty:{t:0,b:{t:2,i:[{t:3}],s:"vazio"}}},sw:{editCaption:{added:{t:0,b:{t:2,i:[{t:3}],s:"(imeongezwa)"}},deleted:{t:0,b:{t:2,i:[{t:3}],s:"(imefutwa)"}}},empty:{t:0,b:{t:2,i:[{t:3}],s:"tupu"}}},"zh-Hant":{editCaption:{added:{t:0,b:{t:2,i:[{t:3}],s:"(已增加)"}},deleted:{t:0,b:{t:2,i:[{t:3}],s:"(已刪除)"}}},empty:{t:0,b:{t:2,i:[{t:3}],s:"空的"}}}}})}const B={name:"DiffItem",props:{path:{type:Array,required:!0},parentPath:{type:Array,default:bt([])},old:null,new:null},computed:{isAtomicChange(){return!(this.old==null&&typeof this.new=="object"||this.new==null&&typeof this.old=="object")},visiblePath(){return this.isAtomicChange?this.path.slice(0,this.path.length-1):this.path},fieldName(){return A(this.path)},nestedClass(){return this.parentPath.length===0?"outer-item":"inner-item"},newValue(){return this.new},typeOfChange(){return this.old==null?"added":"deleted"},nestedDiffs(){return this.flattenDiff(this.new||this.old,this.typeOfChange)}},methods:{flattenDiff(e,t,s=[]){const r=[];for(const m in e){const i=s.concat(m);Array.isArray(e)&&(i.pop(),i.pop(),i.push([s[s.length-1],Number.parseInt(m,10)])),typeof e[m]=="object"?r.push(...this.flattenDiff(e[m],t,i)):t==="added"?r.push({path:i,old:null,new:e[m]}):r.push({path:i,old:e[m],new:null})}return r}}},Mt={key:0,class:"full-path"},Ht={key:1},Wt={key:2,class:"field-separator"},Tt={class:"diff-details"},Nt={class:"field-name"},Ut={class:"old-to-new"},Kt={key:0,class:"data-old"},$t={key:1,class:"data-empty"},Gt={key:2,class:"data-new"},Jt={key:3,class:"data-empty"};function Zt(e,t,s,r,m,i){const v=l("diff-item",!0),c=R("tooltip");return n(),o("div",{class:T(["diff-item",i.nestedClass])},[i.visiblePath.length>0?(n(),o("div",Mt,[(n(!0),o(f,null,V(i.visiblePath,(b,h)=>(n(),o("span",{key:h},[Array.isArray(b)?(n(),o(f,{key:0},[a("span",null,d(b[0]),1),t[0]||(t[0]=a("span",{class:"field-counter"}," #",-1)),a("span",null,d(b[1]+1),1)],64)):(n(),o("span",Ht,d(b),1)),h<i.visiblePath.length-1?(n(),o("span",Wt," › ")):w("",!0)]))),128))])):w("",!0),a("div",Tt,[i.isAtomicChange?(n(),o(f,{key:0},[I((n(),o("div",Nt,[k(d(i.fieldName),1)])),[[c,void 0,void 0,{text:!0}]]),a("div",Ut,[s.old?I((n(),o("span",Kt,[q(e.$slots,"default",{path:s.path,parentPath:s.parentPath,value:s.old,isOld:!0},()=>[k(d(s.old),1)])])),[[c,void 0,void 0,{text:!0}]]):(n(),o("span",$t,d(e.$t("empty")),1)),t[1]||(t[1]=a("span",{class:"icon-arrow-circle-right"},null,-1)),i.newValue?I((n(),o("span",Gt,[q(e.$slots,"default",{path:s.path,parentPath:s.parentPath,value:i.newValue,isOld:!1},()=>[k(d(i.newValue),1)])])),[[c,void 0,void 0,{text:!0}]]):(n(),o("span",Jt,d(e.$t("empty")),1))])],64)):(n(),o(f,{key:1},[a("div",{class:T(["nested-change-type",i.typeOfChange])},d(e.$t(`editCaption.${i.typeOfChange}`)),3),a("div",null,[(n(!0),o(f,null,V(i.nestedDiffs,(b,h)=>(n(),S(v,P({key:h},{ref_for:!0},b,{"parent-path":s.path}),{default:p(y=>[q(e.$slots,"default",P({ref_for:!0},y),()=>[k(d(y.value),1)])]),_:2},1040,["parent-path"]))),128))])],64))])],2)}typeof G=="function"&&G(B);typeof J=="function"&&J(B);const Qt=D(B,[["render",Zt]]),Yt={name:"SubmissionDiffItem",components:{DiffItem:Qt},props:{projectId:{type:String,required:!0},xmlFormId:{type:String,required:!0},instanceId:{type:String,required:!0},oldVersionId:{type:String,required:!1},newVersionId:{type:String,required:!1},entry:{type:Object,required:!0}},setup(){const{fields:e}=x();return{fields:e}},methods:{isBinary(e,t){const m=`/${e.concat(t.filter(i=>i[0]!==void 0)).map(i=>Array.isArray(i)?i[0]:i).join("/")}`;return!!this.fields.binaryPaths.has(m)},binaryHref(e,t){return g.submissionVersionAttachment(this.projectId,this.xmlFormId,this.instanceId,t?this.oldVersionId:this.newVersionId,e)}}},Xt=["href"];function te(e,t,s,r,m,i){const v=l("diff-item",!0);return n(),S(v,vt(pt(s.entry)),{default:p(({parentPath:c,path:b,value:h,isOld:y})=>[i.isBinary(c,b)?(n(),o("a",{key:0,href:i.binaryHref(h,y)},d(h),9,Xt)):(n(),o(f,{key:1},[k(d(h),1)],64))]),_:1},16)}const ee=D(Yt,[["render",te]]);function Z(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{en:{title:{create:{t:0,b:{t:2,i:[{t:3,v:"Submitted by "},{t:4,k:"name"}]}},entity:{create:{t:0,b:{t:2,i:[{t:3,v:"Created Entity "},{t:4,k:"label"},{t:3,v:" in "},{t:4,k:"dataset"},{t:3,v:" Entity List"}]}},update:{t:0,b:{t:2,i:[{t:3,v:"Updated Entity "},{t:4,k:"label"},{t:3,v:" in "},{t:4,k:"dataset"},{t:3,v:" Entity List"}]}},error:{t:0,b:{t:2,i:[{t:3}],s:"Problem processing Entity"}}},updateReviewState:{null:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" per "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Received"}}},hasIssues:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" per "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Has Issues"}}},edited:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" by "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Edited"}}},approved:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" by "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Approved"}}},rejected:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" by "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Rejected"}}}},comment:{t:0,b:{t:2,i:[{t:3,v:"Comment by "},{t:4,k:"name"}]}},delete:{t:0,b:{t:2,i:[{t:3,v:"Deleted by "},{t:4,k:"name"}]}},undelete:{t:0,b:{t:2,i:[{t:3,v:"Restored by "},{t:4,k:"name"}]}},submissionBacklog:{hold:{t:0,b:{t:2,i:[{t:3}],s:"Waiting for previous Submission in offline update chain before updating Entity"}},force:{t:0,b:{t:2,i:[{t:3}],s:"Processed Submission from backlog without previous Submission in offline update chain"}},reprocess:{t:0,b:{t:2,i:[{t:3}],s:"Previous Submission in offline update chain was received"}}}}}}})}function Q(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{cs:{title:{create:{t:0,b:{t:2,i:[{t:3,v:"Odesláno od "},{t:4,k:"name"}]}},updateReviewState:{null:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" u "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Přijato"}}},hasIssues:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" u "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Má problémy"}}},edited:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" u "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Upraveno"}}},approved:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" u "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Schváleno"}}},rejected:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" u "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Odmítnuto"}}}},comment:{t:0,b:{t:2,i:[{t:3,v:"Komentář od "},{t:4,k:"name"}]}}}},de:{title:{create:{t:0,b:{t:2,i:[{t:3,v:"Übermittelt von "},{t:4,k:"name"}]}},entity:{create:{t:0,b:{t:2,i:[{t:3,v:"Entität "},{t:4,k:"label"},{t:3,v:" in "},{t:4,k:"dataset"},{t:3,v:" Entitätsliste erzeugt"}]}},update:{t:0,b:{t:2,i:[{t:3,v:"Entität "},{t:4,k:"label"},{t:3,v:" in "},{t:4,k:"dataset"},{t:3,v:" Entitätsliste aktualisiert"}]}},error:{t:0,b:{t:2,i:[{t:3}],s:"Problem beim Erstellen einer Entität"}}},updateReviewState:{null:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" • "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Empfangen"}}},hasIssues:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" • "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Hat Probleme"}}},edited:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" • "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Bearbeitet"}}},approved:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" • "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Bestätigt"}}},rejected:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" • "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Abgelehnt"}}}},comment:{t:0,b:{t:2,i:[{t:3,v:"Kommentiert von "},{t:4,k:"name"}]}},delete:{t:0,b:{t:2,i:[{t:3,v:"Gelöscht von "},{t:4,k:"name"}]}},undelete:{t:0,b:{t:2,i:[{t:3,v:"Wiederhergestellt von "},{t:4,k:"name"}]}},submissionBacklog:{hold:{t:0,b:{t:2,i:[{t:3}],s:"Warten auf die vorherige Übermittlung in der Offline-Aktualisierungskette vor der Aktualisierung der Entität"}},force:{t:0,b:{t:2,i:[{t:3}],s:"Bearbeitete Übermittlung aus dem Rückstand ohne vorherige Übermittlung in der Offline-Verbuchungskette"}},reprocess:{t:0,b:{t:2,i:[{t:3}],s:"Die vorherige Übermittlung in der Offline-Aktualisierungskette wurde empfangen"}}}}},es:{title:{create:{t:0,b:{t:2,i:[{t:3,v:"Enviado por "},{t:4,k:"name"}]}},entity:{create:{t:0,b:{t:2,i:[{t:3,v:"Entidad creada "},{t:4,k:"label"},{t:3,v:" en "},{t:4,k:"dataset"},{t:3,v:" Lista de entidades"}]}},update:{t:0,b:{t:2,i:[{t:3,v:"Entidad Actualizada "},{t:4,k:"label"},{t:3,v:" en "},{t:4,k:"dataset"},{t:3,v:" Lista de entidades"}]}},error:{t:0,b:{t:2,i:[{t:3}],s:"Problema procesando la Entidad"}}},updateReviewState:{null:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" por "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Recibido"}}},hasIssues:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" por "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Tiene problemas"}}},edited:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" por "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Editado"}}},approved:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" por "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Aprobado"}}},rejected:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" por "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Rechazado"}}}},comment:{t:0,b:{t:2,i:[{t:3,v:"Comentario por "},{t:4,k:"name"}]}},delete:{t:0,b:{t:2,i:[{t:3,v:"Eliminado por "},{t:4,k:"name"}]}},undelete:{t:0,b:{t:2,i:[{t:3,v:"Restablecido por "},{t:4,k:"name"}]}},submissionBacklog:{hold:{t:0,b:{t:2,i:[{t:3}],s:"Esperar al envío anterior en la cadena de actualización offline antes de actualizar la entidad"}},force:{t:0,b:{t:2,i:[{t:3}],s:"Presentación procesada desde la cartera de pedidos sin presentación previa en la cadena de actualización offline"}},reprocess:{t:0,b:{t:2,i:[{t:3}],s:"Se ha recibido el envío anterior en la cadena de actualización offline"}}}}},fr:{title:{create:{t:0,b:{t:2,i:[{t:3,v:"Soumis par "},{t:4,k:"name"}]}},entity:{create:{t:0,b:{t:2,i:[{t:3,v:"Création de l'entité "},{t:4,k:"label"},{t:3,v:" dans la liste "},{t:4,k:"dataset"}]}},update:{t:0,b:{t:2,i:[{t:4,k:"label"},{t:3,v:" Entité mise à jour dans "},{t:4,k:"dataset"},{t:3,v:" Listes d'Entités"}]}},error:{t:0,b:{t:2,i:[{t:3}],s:"Problème lors du traitement de l'Entité"}}},updateReviewState:{null:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" d'un envoi de "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Reçue"}}},hasIssues:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" selon "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Comporte des erreurs"}}},edited:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" par "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Éditée"}}},approved:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" par "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Approuvée"}}},rejected:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" par "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Rejetée"}}}},comment:{t:0,b:{t:2,i:[{t:3,v:"Commentaire de "},{t:4,k:"name"}]}},delete:{t:0,b:{t:2,i:[{t:3,v:"Supprimée par "},{t:4,k:"name"}]}},undelete:{t:0,b:{t:2,i:[{t:3,v:"Restauré par "},{t:4,k:"name"}]}},submissionBacklog:{hold:{t:0,b:{t:2,i:[{t:3}],s:"En attente d'une soumission précédente dans une série de mises à jour effectuées hors ligne avant de mettre l'Entité à jour"}},force:{t:0,b:{t:2,i:[{t:3}],s:"Soumission retenue et puis traitée sans la soumission qui la précéderait dans la série de mises à jour effectuées hors ligne"}},reprocess:{t:0,b:{t:2,i:[{t:3}],s:"Soumission précédente dans une série de mises à jours hors ligne à été reçue"}}}}},id:{title:{create:{t:0,b:{t:2,i:[{t:3,v:"Terkirim oleh "},{t:4,k:"name"}]}},updateReviewState:{null:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" per "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Diterima"}}},hasIssues:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" per "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Memiliki masalah"}}},edited:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" oleh "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Diubah"}}},approved:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" oleh "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Disetujui"}}},rejected:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" oleh "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Ditolak"}}}},comment:{t:0,b:{t:2,i:[{t:3,v:"Komentar oleh "},{t:4,k:"name"}]}}}},it:{title:{create:{t:0,b:{t:2,i:[{t:3,v:"Inviato da "},{t:4,k:"name"}]}},entity:{create:{t:0,b:{t:2,i:[{t:3,v:"Entità creata "},{t:4,k:"label"},{t:3,v:" in "},{t:4,k:"dataset"},{t:3,v:" Lista Entità"}]}},update:{t:0,b:{t:2,i:[{t:3,v:"Entità aggiornata "},{t:4,k:"label"},{t:3,v:" in "},{t:4,k:"dataset"},{t:3,v:" Lista Entità"}]}},error:{t:0,b:{t:2,i:[{t:3}],s:"Problema durante la elaborazione dell'Entità"}}},updateReviewState:{null:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" per "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Ricevuto"}}},hasIssues:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" per "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Ha problemi"}}},edited:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" per "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Modificato"}}},approved:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" per "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Approvato"}}},rejected:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" per "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Respinto"}}}},comment:{t:0,b:{t:2,i:[{t:3,v:"Commenti di "},{t:4,k:"name"}]}},delete:{t:0,b:{t:2,i:[{t:3,v:"Eliminato da "},{t:4,k:"name"}]}},undelete:{t:0,b:{t:2,i:[{t:3,v:"Ripristinato da "},{t:4,k:"name"}]}},submissionBacklog:{hold:{t:0,b:{t:2,i:[{t:3}],s:"Attesa di un invio precedente nella catena di aggiornamento offline prima di aggiornare l'entità"}},force:{t:0,b:{t:2,i:[{t:3}],s:"Invio elaborato dall'arretrato senza un invio precedente nella catena di aggiornamento offline"}},reprocess:{t:0,b:{t:2,i:[{t:3}],s:"È stato ricevuto l'invio precedente nella catena di aggiornamento offline"}}}}},ja:{title:{create:{t:0,b:{t:2,i:[{t:4,k:"name"},{t:3,v:"による提出済フォーム"}]}},updateReviewState:{null:{full:{t:0,b:{t:2,i:[{t:4,k:"name"},{t:3,v:"による"},{t:4,k:"reviewState"},{t:3,v:"報告"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"受信済み"}}},hasIssues:{full:{t:0,b:{t:2,i:[{t:4,k:"name"},{t:3,v:"による"},{t:4,k:"reviewState"},{t:3,v:"報告"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"問題有り"}}},edited:{full:{t:0,b:{t:2,i:[{t:4,k:"name"},{t:3,v:"による"},{t:4,k:"reviewState"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"編集済み"}}},approved:{full:{t:0,b:{t:2,i:[{t:4,k:"name"},{t:3,v:"による"},{t:4,k:"reviewState"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"承認済み"}}},rejected:{full:{t:0,b:{t:2,i:[{t:4,k:"name"},{t:3,v:"による"},{t:4,k:"reviewState"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"リジェクト済み"}}}},comment:{t:0,b:{t:2,i:[{t:4,k:"name"},{t:3,v:"によるコメント"}]}}}},pt:{title:{create:{t:0,b:{t:2,i:[{t:3,v:"Enviado por "},{t:4,k:"name"}]}},entity:{create:{t:0,b:{t:2,i:[{t:3,v:"Entidade "},{t:4,k:"label"},{t:3,v:" criada na Lista de Entidades "},{t:4,k:"dataset"}]}},update:{t:0,b:{t:2,i:[{t:3,v:"Entidade "},{t:4,k:"label"},{t:3,v:" atualizada na Lista de Entidades "},{t:4,k:"dataset"}]}},error:{t:0,b:{t:2,i:[{t:3}],s:"Problema ao processar a Entidade"}}},updateReviewState:{null:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" por "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Recebido"}}},hasIssues:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" por "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Contém erros"}}},edited:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" por "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Editado"}}},approved:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" por "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Aprovado"}}},rejected:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" por "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Rejeitado"}}}},comment:{t:0,b:{t:2,i:[{t:3,v:"Comentado por "},{t:4,k:"name"}]}},delete:{t:0,b:{t:2,i:[{t:3,v:"Deletado por "},{t:4,k:"name"}]}},submissionBacklog:{hold:{t:0,b:{t:2,i:[{t:3}],s:"Aguardando Resposta anterior na cadeia de atualização offline antes de atualizar a Entidade"}},force:{t:0,b:{t:2,i:[{t:3}],s:"Resposta processada do backlog sem Resposta anterior na cadeia de atualização offline"}},reprocess:{t:0,b:{t:2,i:[{t:3}],s:"Resposta anterior na cadeia de atualização offline foi recebida"}}}}},sw:{title:{create:{t:0,b:{t:2,i:[{t:3,v:"Imewasilishwa na "},{t:4,k:"name"}]}},entity:{create:{t:0,b:{t:2,i:[{t:3,v:"Imeunda Huluki "},{t:4,k:"label"},{t:3,v:" katika "},{t:4,k:"dataset"},{t:3,v:" Orodha ya Huluki"}]}},update:{t:0,b:{t:2,i:[{t:3,v:"Imesasisha Huluki "},{t:4,k:"label"},{t:3,v:" katika "},{t:4,k:"dataset"},{t:3,v:" Orodha ya Huluki"}]}},error:{t:0,b:{t:2,i:[{t:3}],s:"Tatizo la kuchakata Huluki"}}},updateReviewState:{null:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" kwa "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Imepokelewa"}}},hasIssues:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" kwa "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Ina Masuala"}}},edited:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" kwa "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Imehaririwa"}}},approved:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" kwa "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Imeidhinishwa"}}},rejected:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" kwa "},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"Imekataliwa"}}}},comment:{t:0,b:{t:2,i:[{t:3,v:"Maoni kutoka kwa "},{t:4,k:"name"}]}}}},"zh-Hant":{title:{create:{t:0,b:{t:2,i:[{t:3,v:"由"},{t:4,k:"name"},{t:3,v:"提交"}]}},entity:{create:{t:0,b:{t:2,i:[{t:3,v:"在 "},{t:4,k:"dataset"},{t:3,v:" 實體清單中建立了實體 "},{t:4,k:"label"}]}},update:{t:0,b:{t:2,i:[{t:3,v:"更新了 "},{t:4,k:"dataset"},{t:3,v:" 實體清單中的實體 "},{t:4,k:"label"}]}},error:{t:0,b:{t:2,i:[{t:3}],s:"問題處理實體"}}},updateReviewState:{null:{full:{t:0,b:{t:2,i:[{t:3,v:"每個"},{t:4,k:"name"},{t:3,v:"的"},{t:4,k:"reviewState"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"已收到"}}},hasIssues:{full:{t:0,b:{t:2,i:[{t:3,v:"每個"},{t:4,k:"name"},{t:3,v:"的"},{t:4,k:"reviewState"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"有問題"}}},edited:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" 按照"},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"已編輯"}}},approved:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" 按照"},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"已認可"}}},rejected:{full:{t:0,b:{t:2,i:[{t:4,k:"reviewState"},{t:3,v:" 按照"},{t:4,k:"name"}]}},reviewState:{t:0,b:{t:2,i:[{t:3}],s:"拒絕"}}}},comment:{t:0,b:{t:2,i:[{t:3,v:"由"},{t:4,k:"name"},{t:3,v:"評論"}]}},delete:{t:0,b:{t:2,i:[{t:3,v:"已由 "},{t:4,k:"name"},{t:3,v:" 刪除"}]}},undelete:{t:0,b:{t:2,i:[{t:3,v:"已由"},{t:4,k:"name"},{t:3,v:"恢復"}]}},submissionBacklog:{hold:{t:0,b:{t:2,i:[{t:3}],s:"在更新實體之前等待離線更新鏈中的先前提交"}},force:{t:0,b:{t:2,i:[{t:3}],s:"已處理來自積壓的提交，而離線更新鏈中沒有先前的提交"}},reprocess:{t:0,b:{t:2,i:[{t:3}],s:"前次離線更新鏈提交已收到"}}}}}}})}const L={name:"SubmissionFeedEntry",components:{ActorLink:St,DatasetLink:gt,EntityLink:Lt,FeedEntry:jt,MarkdownView:Dt,SubmissionDiffItem:ee,SubmissionReviewState:at},props:{projectId:{type:String,required:!0},xmlFormId:{type:String,required:!0},instanceId:{type:String,required:!0},entry:{type:Object,required:!0}},setup(){const{diffs:e}=x();return{diffs:e}},computed:{updateOrEdit(){return this.entry.action==="submission.update"||this.entry.action==="submission.update.version"},reviewState(){return this.entry.action==="submission.update"?this.entry.details.reviewState:"edited"},entityDetails(){return this.entry.details.entity},comment(){return this.entry.notes!=null?this.entry.notes:this.entry.body},allDiffs(){const{details:e}=this.entry;if(e==null)return null;const{instanceId:t}=e;return t!=null?this.diffs[t]:null},entryDiffs(){const{allDiffs:e}=this;return e?e.filter(t=>A(t.path)!=="instanceID"&&A(t.path)!=="deprecatedID"):null},newVersionId(){const{details:e}=this.entry;if(e==null)return null;const{instanceId:t}=e;return t},oldVersionId(){const e=this.allDiffs.find(t=>A(t.path)==="deprecatedID");return e==null?null:e.new}}},ie={key:1,class:"entity-label"},se={key:1,class:"entity-label"},ne={class:"submission-feed-entry-entity-error"},ae={class:"entity-error-message"};function re(e,t,s,r,m,i){const v=l("actor-link"),c=l("i18n-t"),b=l("submission-review-state"),h=l("entity-link"),y=l("dataset-link"),_=l("markdown-view"),j=l("submission-diff-item"),E=l("feed-entry",!0),C=R("tooltip");return n(),S(E,{iso:s.entry.loggedAt??s.entry.createdAt,"wrap-title":s.entry.action==="entity.create"||s.entry.action==="entity.update.version"||s.entry.action?.startsWith("submission.backlog"),class:"submission-feed-entry"},{title:p(()=>[s.entry.action==="submission.create"?(n(),o(f,{key:0},[t[0]||(t[0]=a("span",{class:"icon-cloud-upload"},null,-1)),u(c,{keypath:"title.create"},{name:p(()=>[u(v,{actor:s.entry.actor},null,8,["actor"])]),_:1})],64)):s.entry.action==="submission.delete"?(n(),o(f,{key:1},[t[1]||(t[1]=a("span",{class:"icon-trash"},null,-1)),u(c,{keypath:"title.delete"},{name:p(()=>[u(v,{actor:s.entry.actor},null,8,["actor"])]),_:1})],64)):s.entry.action==="submission.restore"?(n(),o(f,{key:2},[t[2]||(t[2]=a("span",{class:"icon-recycle"},null,-1)),u(c,{keypath:"title.undelete"},{name:p(()=>[u(v,{actor:s.entry.actor},null,8,["actor"])]),_:1})],64)):i.updateOrEdit?(n(),S(c,{key:3,keypath:`title.updateReviewState.${i.reviewState}.full`},{reviewState:p(()=>[u(b,{value:i.reviewState,"color-text":""},{default:p(()=>[k(d(e.$t(`title.updateReviewState.${i.reviewState}.reviewState`)),1)]),_:1},8,["value"])]),name:p(()=>[u(v,{actor:s.entry.actor},null,8,["actor"])]),_:1},8,["keypath"])):s.entry.action==="entity.create"?(n(),o(f,{key:4},[t[3]||(t[3]=a("span",{class:"icon-magic-wand entity-icon"},null,-1)),u(c,{keypath:"title.entity.create"},{label:p(()=>[i.entityDetails?.currentVersion?.label!=null?(n(),S(h,{key:0,"project-id":s.projectId,dataset:i.entityDetails.dataset,entity:i.entityDetails},null,8,["project-id","dataset","entity"])):(n(),o("span",ie,d(i.entityDetails.uuid),1))]),dataset:p(()=>[u(y,{"project-id":s.projectId,name:i.entityDetails.dataset},null,8,["project-id","name"])]),_:1})],64)):s.entry.action==="entity.update.version"?(n(),o(f,{key:5},[t[4]||(t[4]=a("span",{class:"icon-magic-wand entity-icon"},null,-1)),u(c,{keypath:"title.entity.update"},{label:p(()=>[i.entityDetails?.currentVersion?.label!=null?(n(),S(h,{key:0,"project-id":s.projectId,dataset:i.entityDetails.dataset,entity:i.entityDetails},null,8,["project-id","dataset","entity"])):(n(),o("span",se,d(i.entityDetails.uuid),1))]),dataset:p(()=>[u(y,{"project-id":s.projectId,name:i.entityDetails.dataset},null,8,["project-id","name"])]),_:1})],64)):s.entry.action==="entity.error"?(n(),o(f,{key:6},[t[5]||(t[5]=a("span",{class:"icon-warning"},null,-1)),a("span",ne,d(e.$t("title.entity.error")),1),I((n(),o("span",ae,[k(d(s.entry.details.problem?.problemDetails?.reason??s.entry.details.errorMessage??""),1)])),[[C,void 0,void 0,{text:!0}]])],64)):s.entry.action?.startsWith("submission.backlog")?(n(),o(f,{key:7},[t[6]||(t[6]=a("span",{class:"icon-clock-o"},null,-1)),a("span",null,d(e.$t(`title.submissionBacklog.${s.entry.action.replace("submission.backlog.","")}`)),1)],64)):i.comment?(n(),o(f,{key:8},[t[7]||(t[7]=a("span",{class:"icon-comment"},null,-1)),u(c,{keypath:"title.comment"},{name:p(()=>[u(v,{actor:s.entry.actor},null,8,["actor"])]),_:1})],64)):(n(),o(f,{key:9},[t[8]||(t[8]=a("span",{class:"icon-question-circle-o"},null,-1)),k(" "+d(s.entry.action),1)],64))]),body:p(()=>[i.comment!=null?(n(),S(_,{key:0,"raw-markdown":i.comment},null,8,["raw-markdown"])):i.entryDiffs!=null?(n(!0),o(f,{key:1},V(i.entryDiffs,(rt,ot)=>(n(),S(j,{key:ot,entry:rt,"project-id":s.projectId,"xml-form-id":s.xmlFormId,"instance-id":s.instanceId,"old-version-id":i.oldVersionId,"new-version-id":i.newVersionId},null,8,["entry","project-id","xml-form-id","instance-id","old-version-id","new-version-id"]))),128)):w("",!0)]),_:1},8,["iso","wrap-title"])}typeof Z=="function"&&Z(L);typeof Q=="function"&&Q(L);const oe=D(L,[["render",re]]),de={name:"SubmissionActivity",components:{Loading:F,PageSection:st,SubmissionComment:Bt,SubmissionFeedEntry:oe},props:{projectId:{type:String,required:!0},xmlFormId:{type:String,required:!0},instanceId:{type:String,required:!0}},emits:["review","comment","delete"],setup(){const{project:e,form:t,submission:s,audits:r,comments:m,diffs:i,fields:v,resourceStates:c}=x(),{editSubmissionPath:b}=z();return{project:e,form:t,submission:s,audits:r,comments:m,diffs:i,fields:v,...c([r,m,i,v]),editSubmissionPath:b}},computed:{editPath(){return this.form.dataExists?this.editSubmissionPath(this.projectId,this.xmlFormId,this.instanceId,this.form.webformsEnabled):null},feed(){return this.dataExists?[...this.audits,...this.comments].sort(Rt(e=>_t.fromISO(e.loggedAt!=null?e.loggedAt:e.createdAt))):null}}},le=["href"],ue={key:1,id:"submission-activity-edit-button",type:"button",class:"btn btn-default","aria-disabled":"true"};function me(e,t,s,r,m,i){const v=l("submission-comment"),c=l("loading"),b=l("submission-feed-entry"),h=l("page-section"),y=R("tooltip");return n(),S(h,{id:"submission-activity"},{heading:p(()=>[a("span",null,d(e.$t("common.activity")),1),r.project.dataExists&&r.project.permits("submission.update")?(n(),o(f,{key:0},[a("button",{id:"submission-activity-review-button",type:"button",class:"btn btn-default",onClick:t[0]||(t[0]=_=>e.$emit("review"))},[t[3]||(t[3]=a("span",{class:"icon-check"},null,-1)),k(d(e.$t("action.review")),1)]),r.submission.dataExists?(n(),o(f,{key:0},[r.submission.__system.status==null?(n(),o("a",{key:0,id:"submission-activity-edit-button",class:"btn btn-default",href:i.editPath},[t[4]||(t[4]=a("span",{class:"icon-pencil"},null,-1)),k(d(e.$t("action.edit")),1)],8,le)):I((n(),o("button",ue,[t[5]||(t[5]=a("span",{class:"icon-pencil"},null,-1)),k(d(e.$t("action.edit")),1)])),[[y,e.$t("submission.editDisabled"),void 0,{"aria-describedby":!0}]])],64)):w("",!0),r.project.dataExists&&r.project.permits("submission.delete")?(n(),o("button",{key:1,id:"submission-activity-delete-button",type:"button",class:"btn btn-default",onClick:t[1]||(t[1]=_=>e.$emit("delete"))},[t[6]||(t[6]=a("span",{class:"icon-trash"},null,-1)),k(d(e.$t("action.delete")),1)])):w("",!0)],64)):w("",!0)]),body:p(()=>[u(v,{"project-id":s.projectId,"xml-form-id":s.xmlFormId,"instance-id":s.instanceId,feed:i.feed,onSuccess:t[2]||(t[2]=_=>e.$emit("comment"))},null,8,["project-id","xml-form-id","instance-id","feed"]),u(c,{state:e.initiallyLoading},null,8,["state"]),i.feed!=null?(n(!0),o(f,{key:0},V(i.feed,(_,j)=>(n(),S(b,{key:j,entry:_,"project-id":s.projectId,"xml-form-id":s.xmlFormId,"instance-id":s.instanceId},null,8,["entry","project-id","xml-form-id","instance-id"]))),128)):w("",!0)]),_:1})}const ce=D(de,[["render",me]]);function Y(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{en:{submissionDetails:{t:0,b:{t:2,i:[{t:3}],s:"Submission Details"}},formVersion:{t:0,b:{t:2,i:[{t:3}],s:"Form version"}},deviceId:{t:0,b:{t:2,i:[{t:3}],s:"Device ID"}},userAgent:{t:0,b:{t:2,i:[{t:3}],s:"User agent"}},attachments:{t:0,b:{t:2,i:[{t:3}],s:"Attachments"}},present:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" file"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" files"}]}]}},expected:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" expected"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" expected"}]}]}},attachmentSummary:{t:0,b:{t:2,i:[{t:4,k:"present"},{t:3,v:" / "},{t:4,k:"expected"}]}}}}})}function X(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{cs:{formVersion:{t:0,b:{t:2,i:[{t:3}],s:"Verze formuláře"}},deviceId:{t:0,b:{t:2,i:[{t:3}],s:"ID zařízení"}},userAgent:{t:0,b:{t:2,i:[{t:3}],s:"Uživatelský agent"}},attachments:{t:0,b:{t:2,i:[{t:3}],s:"Přílohy"}},present:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" soubor"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" soubory"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" souborů"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" soubory"}]}]}},expected:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" očekáván"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" očekávány"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" očekáváno"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" očekávány"}]}]}},attachmentSummary:{t:0,b:{t:2,i:[{t:4,k:"present"},{t:3,v:" / "},{t:4,k:"expected"}]}}},de:{submissionDetails:{t:0,b:{t:2,i:[{t:3}],s:"Übermittlungsdetails"}},formVersion:{t:0,b:{t:2,i:[{t:3}],s:"Formular Version"}},deviceId:{t:0,b:{t:2,i:[{t:3}],s:"Geräte-ID"}},userAgent:{t:0,b:{t:2,i:[{t:3}],s:"User-Agent"}},attachments:{t:0,b:{t:2,i:[{t:3}],s:"Anhänge"}},present:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" Datei"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" Dateien"}]}]}},expected:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" erwartet"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" erwartet"}]}]}},attachmentSummary:{t:0,b:{t:2,i:[{t:4,k:"present"},{t:3,v:" / "},{t:4,k:"expected"}]}}},es:{submissionDetails:{t:0,b:{t:2,i:[{t:3}],s:"Detalles de envío"}},formVersion:{t:0,b:{t:2,i:[{t:3}],s:"Versión formulario"}},deviceId:{t:0,b:{t:2,i:[{t:3}],s:"ID del dispositivo"}},userAgent:{t:0,b:{t:2,i:[{t:3}],s:"Agente de usuario"}},attachments:{t:0,b:{t:2,i:[{t:3}],s:"Adjuntos"}},present:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" file"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" files"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" files"}]}]}},expected:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" expected"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" esperado"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" esperado"}]}]}},attachmentSummary:{t:0,b:{t:2,i:[{t:4,k:"present"},{t:3,v:" / "},{t:4,k:"expected"}]}}},fr:{submissionDetails:{t:0,b:{t:2,i:[{t:3}],s:"Détail de la soumission"}},formVersion:{t:0,b:{t:2,i:[{t:3}],s:"Version de formulaire"}},deviceId:{t:0,b:{t:2,i:[{t:3}],s:"ID d'appareil"}},userAgent:{t:0,b:{t:2,i:[{t:3}],s:'"User agent"'}},attachments:{t:0,b:{t:2,i:[{t:3}],s:"Fichiers joints"}},present:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" fichier"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" fichiers"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" fichiers"}]}]}},expected:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" attendu"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" attendus"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" attendus"}]}]}},attachmentSummary:{t:0,b:{t:2,i:[{t:4,k:"present"},{t:3,v:" / "},{t:4,k:"expected"}]}}},id:{formVersion:{t:0,b:{t:2,i:[{t:3}],s:"Versi formulir"}},deviceId:{t:0,b:{t:2,i:[{t:3}],s:"ID Perangkat"}},attachments:{t:0,b:{t:2,i:[{t:3}],s:"Lampiran"}},present:{t:0,b:{t:2,i:[{t:4,k:"count"},{t:3,v:" berkas"}]}},expected:{t:0,b:{t:2,i:[{t:4,k:"count"},{t:3,v:" diharapkan"}]}},attachmentSummary:{t:0,b:{t:2,i:[{t:4,k:"present"},{t:3,v:" / "},{t:4,k:"expected"}]}}},it:{submissionDetails:{t:0,b:{t:2,i:[{t:3}],s:"Dettagli invio"}},formVersion:{t:0,b:{t:2,i:[{t:3}],s:"Versione formulario"}},deviceId:{t:0,b:{t:2,i:[{t:3}],s:"ID del dispositivo"}},userAgent:{t:0,b:{t:2,i:[{t:3}],s:"Agente utente"}},attachments:{t:0,b:{t:2,i:[{t:3}],s:"Allegati"}},present:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" file"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" files"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" files"}]}]}},expected:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" atteso"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" attesi"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" attesi"}]}]}},attachmentSummary:{t:0,b:{t:2,i:[{t:4,k:"present"},{t:3,v:" / "},{t:4,k:"expected"}]}}},ja:{formVersion:{t:0,b:{t:2,i:[{t:3}],s:"フォームのバージョン"}},deviceId:{t:0,b:{t:2,i:[{t:3}],s:"デバイスID"}},userAgent:{t:0,b:{t:2,i:[{t:3}],s:"ユーザーエージェント"}},present:{t:0,b:{t:2,i:[{t:4,k:"count"},{t:3,v:"件の提出済メディアファイル"}]}},expected:{t:0,b:{t:2,i:[{t:4,k:"count"},{t:3,v:"件の期待されるメディアファイル数"}]}},attachmentSummary:{t:0,b:{t:2,i:[{t:4,k:"present"},{t:3,v:" / "},{t:4,k:"expected"}]}}},pt:{formVersion:{t:0,b:{t:2,i:[{t:3}],s:"Versão do formulário"}},deviceId:{t:0,b:{t:2,i:[{t:3}],s:"ID do dispositivo"}},userAgent:{t:0,b:{t:2,i:[{t:3}],s:"Agente de usuário"}},attachments:{t:0,b:{t:2,i:[{t:3}],s:"Anexos"}},present:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" arquivo"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" arquivos"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" arquivos"}]}]}},expected:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" esperado"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" esperados"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" esperados"}]}]}},attachmentSummary:{t:0,b:{t:2,i:[{t:4,k:"present"},{t:3,v:" / "},{t:4,k:"expected"}]}}},sw:{formVersion:{t:0,b:{t:2,i:[{t:3}],s:"Toleo la fomu"}},deviceId:{t:0,b:{t:2,i:[{t:3}],s:"Kitambulisho cha Kifaa"}},userAgent:{t:0,b:{t:2,i:[{t:3}],s:"Wakala wa mtumiaji"}},attachments:{t:0,b:{t:2,i:[{t:3}],s:"Viambatisho"}},present:{t:0,b:{t:1,c:[{t:2,i:[{t:3,v:"faili "},{t:4,k:"count"}]},{t:2,i:[{t:3,v:"faili "},{t:4,k:"count"}]}]}},expected:{t:0,b:{t:1,c:[{t:2,i:[{t:4,k:"count"},{t:3,v:" inatarajiwa"}]},{t:2,i:[{t:4,k:"count"},{t:3,v:" inatarajiwa"}]}]}},attachmentSummary:{t:0,b:{t:2,i:[{t:4,k:"present"},{t:3,v:" / "},{t:4,k:"expected"}]}}},"zh-Hant":{submissionDetails:{t:0,b:{t:2,i:[{t:3}],s:"提交詳情"}},formVersion:{t:0,b:{t:2,i:[{t:3}],s:"表單版本"}},deviceId:{t:0,b:{t:2,i:[{t:3}],s:"裝置ID"}},userAgent:{t:0,b:{t:2,i:[{t:3}],s:"使用者代理"}},attachments:{t:0,b:{t:2,i:[{t:3}],s:"附件"}},present:{t:0,b:{t:2,i:[{t:4,k:"count"},{t:3,v:" 個檔案"}]}},expected:{t:0,b:{t:2,i:[{t:4,k:"count"},{t:3,v:" 預期的"}]}},attachmentSummary:{t:0,b:{t:2,i:[{t:4,k:"present"},{t:3,v:" / "},{t:4,k:"expected"}]}}}}})}const M={name:"SubmissionBasicDetails",components:{DateTime:xt,FormVersionString:Et,Loading:F,PageSection:st,SubmissionReviewState:at},setup(){const{submission:e,submissionVersion:t,resourceStates:s}=x();return{submission:e,submissionVersion:t,...s([e,t])}},computed:{attachments(){const{attachmentsPresent:e,attachmentsExpected:t}=this.submission.__system;return this.$t("attachmentSummary",{present:this.$tcn("present",e),expected:this.$tcn("expected",t)})},missingAttachment(){const{attachmentsPresent:e,attachmentsExpected:t}=this.submission.__system;return e!==t}}},be={key:0},ve={key:0},pe={key:1},fe={id:"submission-basic-details-user-agent"},ke={key:2};function he(e,t,s,r,m,i){const v=l("loading"),c=l("date-time"),b=l("submission-review-state"),h=l("form-version-string"),y=l("page-section"),_=R("tooltip");return n(),S(y,{id:"submission-basic-details"},{heading:p(()=>[a("span",null,[t[0]||(t[0]=a("span",{class:"icon-file"},null,-1)),k(d(e.$t("submissionDetails")),1)])]),body:p(()=>[u(v,{state:e.initiallyLoading},null,8,["state"]),e.dataExists?(n(),o("dl",be,[a("div",null,[a("dt",null,d(e.$t("header.instanceId")),1),a("dd",null,[I((n(),o("span",null,[k(d(r.submission.__id),1)])),[[_,void 0,void 0,{text:!0}]])])]),a("div",null,[a("dt",null,d(e.$t("header.submitterName")),1),a("dd",null,[I((n(),o("span",null,[k(d(r.submission.__system.submitterName),1)])),[[_,void 0,void 0,{text:!0}]])])]),a("div",null,[a("dt",null,d(e.$t("header.submissionDate")),1),a("dd",null,[u(c,{iso:r.submission.__system.submissionDate},null,8,["iso"])])]),a("div",null,[a("dt",null,d(e.$t("common.reviewState")),1),a("dd",null,[u(b,{value:r.submission.__system.reviewState},null,8,["value"])])]),a("div",null,[a("dt",null,d(e.$t("formVersion")),1),a("dd",null,[u(h,{version:r.submission.__system.formVersion},null,8,["version"])])]),r.submission.__system.deviceId!=null?(n(),o("div",ve,[a("dt",null,d(e.$t("deviceId")),1),a("dd",null,[I((n(),o("span",null,[k(d(r.submission.__system.deviceId),1)])),[[_,void 0,void 0,{text:!0}]])])])):w("",!0),r.submissionVersion.userAgent!=null?(n(),o("div",pe,[a("dt",null,d(e.$t("userAgent")),1),a("dd",fe,d(r.submissionVersion.userAgent),1)])):w("",!0),r.submission.__system.attachmentsExpected!==0?(n(),o("div",ke,[a("dt",null,d(e.$t("attachments")),1),a("dd",null,[a("span",null,d(i.attachments),1),i.missingAttachment?(n(),o(f,{key:0},[t[1]||(t[1]=a("span",{class:"icon-exclamation-triangle"},null,-1)),a("span",null,d(e.$t("submission.missingAttachment")),1)],64)):w("",!0)])])):w("",!0)])):w("",!0)]),_:1})}typeof Y=="function"&&Y(M);typeof X=="function"&&X(M);const ye=D(M,[["render",he]]);function tt(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{en:{back:{title:{t:0,b:{t:2,i:[{t:3}],s:"Submission Detail"}},back:{t:0,b:{t:2,i:[{t:3}],s:"Back to Submissions Table"}}}}}})}function et(e){const t=e;t.__i18n=t.__i18n||[],t.__i18n.push({locale:"",resource:{cs:{back:{title:{t:0,b:{t:2,i:[{t:3}],s:"Detail odeslání"}},back:{t:0,b:{t:2,i:[{t:3}],s:"Zpět k tabulce odeslání"}}}},de:{back:{title:{t:0,b:{t:2,i:[{t:3}],s:"Übermittlungsdetail"}},back:{t:0,b:{t:2,i:[{t:3}],s:"Zurück zur Übermittlungstabelle"}}}},es:{back:{title:{t:0,b:{t:2,i:[{t:3}],s:"Detalle de envío"}},back:{t:0,b:{t:2,i:[{t:3}],s:"Volver a la tabla de envíos"}}}},fr:{back:{title:{t:0,b:{t:2,i:[{t:3}],s:"Détails de la soumission"}},back:{t:0,b:{t:2,i:[{t:3}],s:"Retour au tableau de soumissions"}}}},id:{back:{title:{t:0,b:{t:2,i:[{t:3}],s:"Detail kiriman"}},back:{t:0,b:{t:2,i:[{t:3}],s:"Kembali ke tabel kiriman"}}}},it:{back:{title:{t:0,b:{t:2,i:[{t:3}],s:"Dettagli invio"}},back:{t:0,b:{t:2,i:[{t:3}],s:"Indietro alla tabella degli invii"}}}},ja:{back:{title:{t:0,b:{t:2,i:[{t:3}],s:"提出フォームの詳細"}},back:{t:0,b:{t:2,i:[{t:3}],s:"提出フォームの一覧に戻る"}}}},pt:{back:{title:{t:0,b:{t:2,i:[{t:3}],s:"Detalhes da resposta"}},back:{t:0,b:{t:2,i:[{t:3}],s:"Voltar à tabela de respostas"}}}},sw:{back:{title:{t:0,b:{t:2,i:[{t:3}],s:"Maelezo ya Uwasilishaji"}},back:{t:0,b:{t:2,i:[{t:3}],s:"Rudi kwenye Jedwali la Mawasilisho"}}}},"zh-Hant":{back:{title:{t:0,b:{t:2,i:[{t:3}],s:"提交詳情"}},back:{t:0,b:{t:2,i:[{t:3}],s:"返回提交表"}}}}}})}const H={name:"SubmissionShow",components:{Breadcrumbs:dt,Loading:F,PageBody:ft,PageHead:yt,SubmissionActivity:ce,SubmissionBasicDetails:ye,SubmissionDelete:At,SubmissionUpdateReviewState:Ct},inject:["alert"],props:{projectId:{type:String,required:!0},xmlFormId:{type:String,required:!0},instanceId:{type:String,required:!0}},setup(){const{project:e,form:t,resourceStates:s}=x(),{request:r,awaitingResponse:m}=nt(),{submission:i,submissionVersion:v,audits:c,comments:b,diffs:h}=Pt(),y=Vt(),{t:_}=kt();ht(()=>i.dataExists?[`${_("title.details")}: ${i.instanceNameOrId}`]:[_("title.details")]);const{formPath:j,projectPath:E}=z();return{project:e,form:t,submission:i,submissionVersion:v,audits:c,comments:b,diffs:h,fields:y,request:r,awaitingResponse:m,...s([e,t,i]),reviewModal:U(),deleteModal:U(),formPath:j,projectPath:E}},computed:{breadcrumbLinks(){return[{text:this.project.dataExists?this.project.nameWithArchived:this.$t("resource.project"),path:this.projectPath(),icon:"icon-archive"},{text:this.form.dataExists?this.form.nameOrId:this.$t("resource.form"),path:this.formPath(),icon:"icon-file"},{text:this.submission.instanceNameOrId}]}},created(){this.fetchData()},methods:{fetchActivityData(){Promise.allSettled([this.audits.request({url:g.submissionAudits(this.projectId,this.xmlFormId,this.instanceId),extended:!0}),this.comments.request({url:g.submissionComments(this.projectId,this.xmlFormId,this.instanceId),extended:!0}),this.diffs.request({url:g.submissionDiffs(this.projectId,this.xmlFormId,this.instanceId)})])},fetchData(){Promise.allSettled([this.project.request({url:g.project(this.projectId),extended:!0,resend:!1}),this.form.request({url:g.form(this.projectId,this.xmlFormId),extended:!1}),this.submission.request({url:g.odataSubmission(this.projectId,this.xmlFormId,this.instanceId,{$select:"__id,__system,meta"})}),this.submissionVersion.request({url:g.submissionVersion(this.projectId,this.xmlFormId,this.instanceId,this.instanceId)}),this.fields.request({url:g.fields(this.projectId,this.xmlFormId)})]),this.fetchActivityData()},afterReview(e,t){this.fetchActivityData(),this.reviewModal.hide(),this.alert.success(this.$t("alert.updateReviewState")),this.submission.__system.reviewState=t},requestDelete([{__id:e}]){this.request({method:"DELETE",url:g.submission(this.projectId,this.xmlFormId,e)}).then(()=>{const t=this.$t("alert.submissionDeleted");this.$router.push(this.formPath("submissions")).then(()=>{this.alert.success(t)})}).catch(it)}}},_e={id:"submission-show"},we={class:"row"},Se={class:"col-xs-4"},ge={class:"col-xs-8"};function Ie(e,t,s,r,m,i){const v=l("breadcrumbs"),c=l("page-head"),b=l("loading"),h=l("submission-basic-details"),y=l("submission-activity"),_=l("page-body"),j=l("submission-update-review-state"),E=l("submission-delete");return n(),o("div",_e,[e.dataExists?(n(),S(v,{key:0,links:i.breadcrumbLinks},null,8,["links"])):w("",!0),I(u(c,null,{title:p(()=>[k(d(r.submission.dataExists?r.submission.instanceNameOrId:""),1)]),_:1},512),[[N,e.dataExists]]),u(_,null,{default:p(()=>[u(b,{state:e.initiallyLoading},null,8,["state"]),I(a("div",we,[a("div",Se,[u(h)]),a("div",ge,[u(y,{"project-id":s.projectId,"xml-form-id":s.xmlFormId,"instance-id":s.instanceId,onReview:t[0]||(t[0]=C=>r.reviewModal.show()),onComment:i.fetchActivityData,onDelete:t[1]||(t[1]=C=>r.deleteModal.show())},null,8,["project-id","xml-form-id","instance-id","onComment"])])],512),[[N,e.dataExists]])]),_:1}),u(j,P(r.reviewModal,{"project-id":s.projectId,"xml-form-id":s.xmlFormId,submission:r.submission,onHide:t[2]||(t[2]=C=>r.reviewModal.hide()),onSuccess:i.afterReview}),null,16,["project-id","xml-form-id","submission","onSuccess"]),u(E,P(r.deleteModal,{submission:r.submission,"awaiting-response":r.awaitingResponse,onHide:t[3]||(t[3]=C=>r.deleteModal.hide()),onDelete:i.requestDelete}),null,16,["submission","awaiting-response","onDelete"])])}typeof tt=="function"&&tt(H);typeof et=="function"&&et(H);const Ke=D(H,[["render",Ie]]);export{Ke as default};
